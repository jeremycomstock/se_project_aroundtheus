!function(){"use strict";class e{constructor(e,t){let{cardData:s,handleImageClick:r,handleDeleteButton:n,handleCardLike:o,handleCardUnlike:i}=e;this._cardSelector=t,this._name=s.name,this._link=s.link,this._id=s._id,this._handleImageClick=r,this._handleDeleteButton=n,this._handleCardLike=o,this._handleCardUnlike=i}_getTemplate(){return this._cardSelector.cloneNode(!0)}getId(){return this._id}removeItem(){this._element.remove()}_handleLikeButton=()=>{this._likeButton.classList.contains("card__like-button_active")?this._likeButton.classList.contains("card__like-button_active")&&(this._handleCardUnlike(this._id),this._likeButton.classList.remove("card__like-button_active")):(this._handleCardLike(this._id),this._likeButton.classList.add("card__like-button_active"))};_setEventListeners(){this._likeButton.addEventListener("click",this._handleLikeButton),this._deleteButton.addEventListener("click",this._handleDeleteButton),this._cardImage.addEventListener("click",(()=>{this._handleImageClick({name:this._name,link:this._link})}))}getView(){return this._element=this._getTemplate(),this._cardImage=this._element.querySelector(".card__image"),this._likeButton=this._element.querySelector(".card__like-button"),this._deleteButton=this._element.querySelector(".card__delete-button"),this._cardNameContent=this._element.querySelector(".card__name"),this._cardImage.setAttribute("src",this._link),this._cardImage.setAttribute("alt",this._name),this._cardNameContent.textContent=this._name,this._setEventListeners(),this._element}}class t{constructor(e,t){let{items:s,renderer:r}=e;this._items=s,this._renderer=r,this._container=document.querySelector(t)}renderItems(){this._items.forEach((e=>{this.addItem(e)}))}addItem(e){const t=this._renderer(e);this._container.prepend(t)}}class s{constructor(e,t){this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._formElement=t,this._submitButton=this._formElement.querySelector(this._submitButtonSelector),this._inputList=Array.from(this._formElement.querySelectorAll(this._inputSelector))}_showInputError(e,t){const s=this._formElement.querySelector(`#${t.id}-error`);t.classList.add(this._inputErrorClass),s.textContent=t.validationMessage,s.classList.add(this._errorClass)}_hideInputError(e,t){const s=this._formElement.querySelector(`#${t.id}-error`);t.classList.remove(this._inputErrorClass),s.textContent="",s.classList.remove(this._errorClass)}_hasValidInput(){return!this._inputList.every((e=>e.validity.valid))}toggleButtonState(){this._hasValidInput()?this._disableButton():this._enableButton()}_checkFormValidity(e){this._inputList.forEach((t=>(t.validity.valid||(e=!0),e)))}_disableButton(){this._submitButton.classList.add(this._inactiveButtonClass),this._submitButton.disabled=!0}_enableButton(){this._submitButton.classList.remove(this._inactiveButtonClass),this._submitButton.disabled=!1}checkInputValidity(e,t){t.validity.valid?this._hideInputError(e,t):this._showInputError(e,t)}_setEventListeners(){this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this.checkInputValidity(this._formElement,e),this.toggleButtonState()}))}))}enableValidation(){this._formElement.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}}class r{constructor(e){let{popupSelector:t}=e;this._popupElement=document.querySelector(t),this._closeButton=this._popupElement.querySelector(".modal__close")}open(){this._popupElement.classList.add("modal_opened"),this.setEventListeners()}close(){this._closeButton.removeEventListener("click",this._handleCloseButton),this._popupElement.removeEventListener("click",this._handleClickClose),this._popupElement.classList.remove("modal_opened"),document.removeEventListener("keydown",this._handleEscClose)}_handleCloseButton=()=>{this.close()};_handleClickClose=e=>{e.target==this._popupElement&&this.close()};_handleEscClose=e=>{"Escape"===e.key&&this.close()};setEventListeners(){this._closeButton.addEventListener("click",this._handleCloseButton),this._popupElement.addEventListener("click",this._handleClickClose),document.addEventListener("keydown",this._handleEscClose)}}class n extends r{constructor(e,t){super({popupSelector:e}),this._popupForm=this._popupElement.querySelector(".modal__form"),this._handleFormSubmit=t,this._inputs=this._popupForm.querySelectorAll(".modal__input"),this._submitButton=this._popupElement.querySelector(".modal__button")}_getInputValues(){const e={};return this._inputs.forEach((t=>e[t.name]=t.value)),e}open(){this._submitButton.textContent="Save",super.open()}close(){this._popupForm.removeEventListener("submit",this._handleSubmitButton),this._popupForm.reset(),super.close()}_handleSubmitButton=e=>{this._submitButton.textContent="Saving...",e.preventDefault(),this._handleFormSubmit(this._getInputValues()),this.close()};setEventListeners(){super.setEventListeners(),this._popupForm.addEventListener("submit",this._handleSubmitButton)}}class o extends r{constructor(e,t){super({popupSelector:e}),this._popupForm=this._popupElement.querySelector(".modal__form"),this._handleDeleteConfirm=t,this._submitButton=this._popupElement.querySelector(".modal__button")}open(){this._submitButton.textContent="Save",super.open()}setEventListeners(){super.setEventListeners(),this._popupForm.addEventListener("submit",(e=>{e.preventDefault(),this._handleDeleteConfirm(),super.close()}))}}const i=new class{constructor(e){let{baseUrl:t,headers:s}=e;this._baseUrl=t,this._headers=s,this._token=s.authorization}getInitialCards(){return fetch(`${this._baseUrl}/cards`,{headers:{authorization:this._token}}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`))).catch((e=>{console.error(e)}))}getUserInfo(){return fetch(`${this._baseUrl}/users/me`,{headers:{authorization:this._token}}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`))).catch((e=>{console.error(e)}))}getAvatar(){return fetch(`${this._baseUrl}/users/me`,{headers:{authorization:this._token}}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`))).catch((e=>{console.error(e)}))}getId(){return fetch(`${this._baseUrl}/cards/:cardId`,{headers:{authorization:this._token}}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`))).catch((e=>{console.error(e)}))}updateProfile(e){return fetch(`${this._baseUrl}/users/me`,{method:"PATCH",headers:{authorization:this._token,"Content-Type":"application/json"},body:JSON.stringify({name:e.name,about:e.description})}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`))).catch((e=>{console.error(e)}))}updateAvatar(e){return fetch(`${this._baseUrl}/users/me/avatar`,{method:"PATCH",headers:{authorization:this._token,"Content-Type":"application/json"},body:JSON.stringify({avatar:e.avatar})}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`))).catch((e=>{console.error(e)}))}addCard(e){let{name:t,link:s}=e;return fetch(`${this._baseUrl}/cards`,{method:"POST",headers:{authorization:this._token,"Content-Type":"application/json"},body:JSON.stringify({name:t,link:s})}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`))).catch((e=>{console.error(e)}))}removeCard(e){return fetch(`${this._baseUrl}/cards/${e}`,{method:"DELETE",headers:{authorization:this._token,"Content-Type":"application/json",message:"This post has been deleted"}}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`))).catch((e=>{console.error(e)}))}likeCard(e){return fetch(`${this._baseUrl}/cards/${e}/likes`,{method:"PUT",headers:{authorization:this._token}}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`))).catch((e=>{console.error(e)}))}unlikeCard(e){return fetch(`${this._baseUrl}/cards/${e}/likes`,{method:"DELETE",headers:{authorization:this._token}}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`))).catch((e=>{console.error(e)}))}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"7d9b26b0-78d0-422a-941a-09c95ea2b082","Content-Type":"application/json"}});i.getUserInfo().then((e=>{y.setUserInfo({name:e.name,description:e.about})})),i.getUserInfo().then((e=>{_.setAttribute("src",e.avatar)}));const a=document.querySelector(".profile__edit-button"),l=document.querySelector(".profile__add-button"),c=document.querySelector(".modal_type_edit"),h=document.forms["profile-form"],u=c.querySelector("#name"),d=c.querySelector("#description"),_=document.querySelector(".profile__avatar"),m=document.querySelector(".profile__avatar-overlay"),p=(document.querySelector(".modal_type_avatar").querySelector("#avatar-link"),document.forms["avatar-form"]),v=document.forms["card-form"],k=document.querySelector(".gallery__cards").querySelector("#gallery-template").content.querySelector(".card");function E(e){B.open(e)}a.addEventListener("click",(()=>{const{name:e,description:t}=y.getUserInfo();u.value=e,d.value=t,g.open()})),m.addEventListener("click",(()=>{console.log("Hello from avatar click"),L.open()}));const b=new class{constructor(){this.validationSettings={formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__button",inactiveButtonClass:"modal__button_disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__error_visible"}}},C=new s(b.validationSettings,h),f=new s(b.validationSettings,v),S=new s(b.validationSettings,p),y=new class{constructor(e){let{name:t,description:s}=e;this._name=document.querySelector(t),this._description=document.querySelector(s)}getUserInfo(){return{name:this._name.textContent,description:this._description.textContent}}setUserInfo(e){let{name:t,description:s}=e;this._name.textContent=t,this._description.textContent=s}}({name:".profile__name",description:".profile__description"}),g=new n("#edit-popup",(function(e){i.updateProfile(e).then((e=>{y.setUserInfo({name:e.name,description:e.about})}))})),L=new n("#avatar-popup",(function(e){i.updateAvatar(e),i.getUserInfo().then((t=>{_.setAttribute("src",e.avatar)}))})),B=new class extends r{constructor(e){super({popupSelector:e}),this._previewImage=document.querySelector(".modal__preview-image"),this._previewName=document.querySelector(".modal__preview-name")}open(e){let{name:t,link:s}=e;this._previewImage.src=s,this._previewImage.alt=t,this._previewName.textContent=t,super.open()}}("#preview-image-popup");C.enableValidation(),f.enableValidation(),S.enableValidation(),i.getInitialCards().then((s=>{const r=new t({items:s,renderer:function(t){const s=new e({cardData:t,handleImageClick:E,handleDeleteButton:function(){console.log(document.querySelector(".modal_type_delete")),r.open()},handleCardLike:function(e){i.likeCard(e)},handleCardUnlike:function(e){i.unlikeCard(e)}},k),r=new o("#delete-popup",(()=>{let e=s.getId();i.removeCard(e),s.removeItem()}));return s.getView()}},".gallery__cards"),a=new n("#new-card-popup",(function(e){let{title:t,link:s}=e;i.addCard({name:t,link:s}).then((e=>{r.addItem(e)})),a.close()}));l.addEventListener("click",(()=>{f.toggleButtonState(),a.open()})),r.renderItems()}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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dGljdW0vLi9zcmMvY29tcG9uZW50cy9DYXJkLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1NlY3Rpb24uanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Qb3B1cC5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1BvcHVwRGVsZXRlLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9wYWdlcy9pbmRleC5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9BcGkuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL3V0aWxzL2NvbnN0YW50cy5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Vc2VySW5mby5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgZGVmYXVsdCBjbGFzcyBDYXJkIHtcclxuICBjb25zdHJ1Y3RvcihcclxuICAgIHtcclxuICAgICAgY2FyZERhdGEsXHJcbiAgICAgIGhhbmRsZUltYWdlQ2xpY2ssXHJcbiAgICAgIGhhbmRsZURlbGV0ZUJ1dHRvbixcclxuICAgICAgaGFuZGxlQ2FyZExpa2UsXHJcbiAgICAgIGhhbmRsZUNhcmRVbmxpa2UsXHJcbiAgICB9LFxyXG4gICAgY2FyZFNlbGVjdG9yXHJcbiAgKSB7XHJcbiAgICB0aGlzLl9jYXJkU2VsZWN0b3IgPSBjYXJkU2VsZWN0b3I7XHJcbiAgICB0aGlzLl9uYW1lID0gY2FyZERhdGEubmFtZTtcclxuICAgIHRoaXMuX2xpbmsgPSBjYXJkRGF0YS5saW5rO1xyXG4gICAgdGhpcy5faWQgPSBjYXJkRGF0YS5faWQ7XHJcblxyXG4gICAgdGhpcy5faGFuZGxlSW1hZ2VDbGljayA9IGhhbmRsZUltYWdlQ2xpY2s7XHJcbiAgICB0aGlzLl9oYW5kbGVEZWxldGVCdXR0b24gPSBoYW5kbGVEZWxldGVCdXR0b247XHJcbiAgICB0aGlzLl9oYW5kbGVDYXJkTGlrZSA9IGhhbmRsZUNhcmRMaWtlO1xyXG4gICAgdGhpcy5faGFuZGxlQ2FyZFVubGlrZSA9IGhhbmRsZUNhcmRVbmxpa2U7XHJcbiAgfVxyXG5cclxuICBfZ2V0VGVtcGxhdGUoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5fY2FyZFNlbGVjdG9yLmNsb25lTm9kZSh0cnVlKTtcclxuICB9XHJcblxyXG4gIGdldElkKCkge1xyXG4gICAgcmV0dXJuIHRoaXMuX2lkO1xyXG4gIH1cclxuXHJcbiAgcmVtb3ZlSXRlbSgpIHtcclxuICAgIHRoaXMuX2VsZW1lbnQucmVtb3ZlKCk7XHJcbiAgfVxyXG5cclxuICBfaGFuZGxlTGlrZUJ1dHRvbiA9ICgpID0+IHtcclxuICAgIGlmICghdGhpcy5fbGlrZUJ1dHRvbi5jbGFzc0xpc3QuY29udGFpbnMoXCJjYXJkX19saWtlLWJ1dHRvbl9hY3RpdmVcIikpIHtcclxuICAgICAgdGhpcy5faGFuZGxlQ2FyZExpa2UodGhpcy5faWQpO1xyXG4gICAgICB0aGlzLl9saWtlQnV0dG9uLmNsYXNzTGlzdC5hZGQoXCJjYXJkX19saWtlLWJ1dHRvbl9hY3RpdmVcIik7XHJcbiAgICB9IGVsc2UgaWYgKFxyXG4gICAgICB0aGlzLl9saWtlQnV0dG9uLmNsYXNzTGlzdC5jb250YWlucyhcImNhcmRfX2xpa2UtYnV0dG9uX2FjdGl2ZVwiKVxyXG4gICAgKSB7XHJcbiAgICAgIHRoaXMuX2hhbmRsZUNhcmRVbmxpa2UodGhpcy5faWQpO1xyXG4gICAgICB0aGlzLl9saWtlQnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUoXCJjYXJkX19saWtlLWJ1dHRvbl9hY3RpdmVcIik7XHJcbiAgICB9XHJcbiAgfTtcclxuXHJcbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgdGhpcy5fbGlrZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgdGhpcy5faGFuZGxlTGlrZUJ1dHRvbik7XHJcbiAgICB0aGlzLl9kZWxldGVCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIHRoaXMuX2hhbmRsZURlbGV0ZUJ1dHRvbik7XHJcbiAgICB0aGlzLl9jYXJkSW1hZ2UuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgICAgdGhpcy5faGFuZGxlSW1hZ2VDbGljayh7XHJcbiAgICAgICAgbmFtZTogdGhpcy5fbmFtZSxcclxuICAgICAgICBsaW5rOiB0aGlzLl9saW5rLFxyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgZ2V0VmlldygpIHtcclxuICAgIHRoaXMuX2VsZW1lbnQgPSB0aGlzLl9nZXRUZW1wbGF0ZSgpO1xyXG4gICAgdGhpcy5fY2FyZEltYWdlID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2ltYWdlXCIpO1xyXG4gICAgdGhpcy5fbGlrZUJ1dHRvbiA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19saWtlLWJ1dHRvblwiKTtcclxuICAgIHRoaXMuX2RlbGV0ZUJ1dHRvbiA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19kZWxldGUtYnV0dG9uXCIpO1xyXG4gICAgdGhpcy5fY2FyZE5hbWVDb250ZW50ID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX25hbWVcIik7XHJcblxyXG4gICAgdGhpcy5fY2FyZEltYWdlLnNldEF0dHJpYnV0ZShcInNyY1wiLCB0aGlzLl9saW5rKTtcclxuICAgIHRoaXMuX2NhcmRJbWFnZS5zZXRBdHRyaWJ1dGUoXCJhbHRcIiwgdGhpcy5fbmFtZSk7XHJcblxyXG4gICAgdGhpcy5fY2FyZE5hbWVDb250ZW50LnRleHRDb250ZW50ID0gdGhpcy5fbmFtZTtcclxuXHJcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xyXG4gICAgcmV0dXJuIHRoaXMuX2VsZW1lbnQ7XHJcbiAgfVxyXG59XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFNlY3Rpb24ge1xyXG4gIGNvbnN0cnVjdG9yKHsgaXRlbXMsIHJlbmRlcmVyIH0sIGNvbnRhaW5lclNlbGVjdG9yKSB7XHJcbiAgICB0aGlzLl9pdGVtcyA9IGl0ZW1zO1xyXG4gICAgdGhpcy5fcmVuZGVyZXIgPSByZW5kZXJlcjtcclxuICAgIHRoaXMuX2NvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoY29udGFpbmVyU2VsZWN0b3IpO1xyXG4gIH1cclxuXHJcbiAgcmVuZGVySXRlbXMoKSB7XHJcbiAgICB0aGlzLl9pdGVtcy5mb3JFYWNoKChjYXJkRGF0YSkgPT4ge1xyXG4gICAgICB0aGlzLmFkZEl0ZW0oY2FyZERhdGEpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBhZGRJdGVtKGNhcmREYXRhKSB7XHJcbiAgICBjb25zdCBjYXJkRWxlbWVudCA9IHRoaXMuX3JlbmRlcmVyKGNhcmREYXRhKTtcclxuICAgIHRoaXMuX2NvbnRhaW5lci5wcmVwZW5kKGNhcmRFbGVtZW50KTtcclxuICB9XHJcbn1cclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgRm9ybVZhbGlkYXRvciB7XHJcbiAgY29uc3RydWN0b3Ioc2V0dGluZ3MsIGZvcm1FbGVtZW50KSB7XHJcbiAgICB0aGlzLl9pbnB1dFNlbGVjdG9yID0gc2V0dGluZ3MuaW5wdXRTZWxlY3RvcjtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvblNlbGVjdG9yID0gc2V0dGluZ3Muc3VibWl0QnV0dG9uU2VsZWN0b3I7XHJcbiAgICB0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzID0gc2V0dGluZ3MuaW5hY3RpdmVCdXR0b25DbGFzcztcclxuICAgIHRoaXMuX2lucHV0RXJyb3JDbGFzcyA9IHNldHRpbmdzLmlucHV0RXJyb3JDbGFzcztcclxuICAgIHRoaXMuX2Vycm9yQ2xhc3MgPSBzZXR0aW5ncy5lcnJvckNsYXNzO1xyXG5cclxuICAgIHRoaXMuX2Zvcm1FbGVtZW50ID0gZm9ybUVsZW1lbnQ7XHJcblxyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcclxuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3JcclxuICAgICk7XHJcblxyXG4gICAgdGhpcy5faW5wdXRMaXN0ID0gQXJyYXkuZnJvbShcclxuICAgICAgdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvckFsbCh0aGlzLl9pbnB1dFNlbGVjdG9yKVxyXG4gICAgKTtcclxuICB9XHJcblxyXG4gIF9zaG93SW5wdXRFcnJvcihmb3JtRWxlbWVudCwgaW5wdXRFbGVtZW50KSB7XHJcbiAgICBjb25zdCBlcnJvckVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICBgIyR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmBcclxuICAgICk7XHJcbiAgICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xyXG4gICAgZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gaW5wdXRFbGVtZW50LnZhbGlkYXRpb25NZXNzYWdlO1xyXG4gICAgZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5fZXJyb3JDbGFzcyk7XHJcbiAgfVxyXG5cclxuICBfaGlkZUlucHV0RXJyb3IoZm9ybUVsZW1lbnQsIGlucHV0RWxlbWVudCkge1xyXG4gICAgY29uc3QgZXJyb3JFbGVtZW50ID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcclxuICAgICAgYCMke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgXHJcbiAgICApO1xyXG4gICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcclxuICAgIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IFwiXCI7XHJcbiAgICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9lcnJvckNsYXNzKTtcclxuICB9XHJcblxyXG4gIF9oYXNWYWxpZElucHV0KCkge1xyXG4gICAgcmV0dXJuICF0aGlzLl9pbnB1dExpc3QuZXZlcnkoKGlucHV0RWwpID0+IGlucHV0RWwudmFsaWRpdHkudmFsaWQpO1xyXG4gIH1cclxuXHJcbiAgdG9nZ2xlQnV0dG9uU3RhdGUoKSB7XHJcbiAgICBpZiAodGhpcy5faGFzVmFsaWRJbnB1dCgpKSB7XHJcbiAgICAgIHRoaXMuX2Rpc2FibGVCdXR0b24oKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuX2VuYWJsZUJ1dHRvbigpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgX2NoZWNrRm9ybVZhbGlkaXR5KGZvdW5kSW52YWxpZCkge1xyXG4gICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goKGlucHV0RWwpID0+IHtcclxuICAgICAgaWYgKCFpbnB1dEVsLnZhbGlkaXR5LnZhbGlkKSB7XHJcbiAgICAgICAgZm91bmRJbnZhbGlkID0gdHJ1ZTtcclxuICAgICAgfVxyXG4gICAgICByZXR1cm4gZm91bmRJbnZhbGlkO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBfZGlzYWJsZUJ1dHRvbigpIHtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5jbGFzc0xpc3QuYWRkKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uLmRpc2FibGVkID0gdHJ1ZTtcclxuICB9XHJcblxyXG4gIF9lbmFibGVCdXR0b24oKSB7XHJcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24uY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5kaXNhYmxlZCA9IGZhbHNlO1xyXG4gIH1cclxuXHJcbiAgY2hlY2tJbnB1dFZhbGlkaXR5KGZvcm1FbGVtZW50LCBpbnB1dEVsKSB7XHJcbiAgICBpZiAoIWlucHV0RWwudmFsaWRpdHkudmFsaWQpIHtcclxuICAgICAgdGhpcy5fc2hvd0lucHV0RXJyb3IoZm9ybUVsZW1lbnQsIGlucHV0RWwpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IoZm9ybUVsZW1lbnQsIGlucHV0RWwpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goKGlucHV0RWwpID0+IHtcclxuICAgICAgaW5wdXRFbC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgKCkgPT4ge1xyXG4gICAgICAgIHRoaXMuY2hlY2tJbnB1dFZhbGlkaXR5KHRoaXMuX2Zvcm1FbGVtZW50LCBpbnB1dEVsKTtcclxuICAgICAgICB0aGlzLnRvZ2dsZUJ1dHRvblN0YXRlKCk7XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBlbmFibGVWYWxpZGF0aW9uKCkge1xyXG4gICAgdGhpcy5fZm9ybUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZSkgPT4ge1xyXG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICB9KTtcclxuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgfVxyXG59XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcih7IHBvcHVwU2VsZWN0b3IgfSkge1xyXG4gICAgdGhpcy5fcG9wdXBFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihwb3B1cFNlbGVjdG9yKTtcclxuICAgIHRoaXMuX2Nsb3NlQnV0dG9uID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Nsb3NlXCIpO1xyXG4gIH1cclxuXHJcbiAgb3BlbigpIHtcclxuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5jbGFzc0xpc3QuYWRkKFwibW9kYWxfb3BlbmVkXCIpO1xyXG4gICAgdGhpcy5zZXRFdmVudExpc3RlbmVycygpO1xyXG4gIH1cclxuXHJcbiAgY2xvc2UoKSB7XHJcbiAgICB0aGlzLl9jbG9zZUJ1dHRvbi5yZW1vdmVFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgdGhpcy5faGFuZGxlQ2xvc2VCdXR0b24pO1xyXG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCB0aGlzLl9oYW5kbGVDbGlja0Nsb3NlKTtcclxuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKFwibW9kYWxfb3BlbmVkXCIpO1xyXG4gICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlRXNjQ2xvc2UpO1xyXG4gIH1cclxuXHJcbiAgX2hhbmRsZUNsb3NlQnV0dG9uID0gKCkgPT4ge1xyXG4gICAgdGhpcy5jbG9zZSgpO1xyXG4gIH07XHJcblxyXG4gIF9oYW5kbGVDbGlja0Nsb3NlID0gKGUpID0+IHtcclxuICAgIGlmIChlLnRhcmdldCA9PSB0aGlzLl9wb3B1cEVsZW1lbnQpIHtcclxuICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgfVxyXG4gIH07XHJcblxyXG4gIF9oYW5kbGVFc2NDbG9zZSA9IChlKSA9PiB7XHJcbiAgICBpZiAoZS5rZXkgPT09IFwiRXNjYXBlXCIpIHtcclxuICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgfVxyXG4gIH07XHJcblxyXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgdGhpcy5fY2xvc2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIHRoaXMuX2hhbmRsZUNsb3NlQnV0dG9uKTtcclxuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgdGhpcy5faGFuZGxlQ2xpY2tDbG9zZSk7XHJcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoRm9ybSBleHRlbmRzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yLCBoYW5kbGVGb3JtU3VibWl0KSB7XHJcbiAgICBzdXBlcih7IHBvcHVwU2VsZWN0b3IgfSk7XHJcbiAgICB0aGlzLl9wb3B1cEZvcm0gPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybVwiKTtcclxuICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQgPSBoYW5kbGVGb3JtU3VibWl0O1xyXG4gICAgdGhpcy5faW5wdXRzID0gdGhpcy5fcG9wdXBGb3JtLnF1ZXJ5U2VsZWN0b3JBbGwoXCIubW9kYWxfX2lucHV0XCIpO1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2J1dHRvblwiKTtcclxuICB9XHJcblxyXG4gIF9nZXRJbnB1dFZhbHVlcygpIHtcclxuICAgIGNvbnN0IGlucHV0VmFsdWVzID0ge307XHJcbiAgICB0aGlzLl9pbnB1dHMuZm9yRWFjaCgoaW5wdXQpID0+IChpbnB1dFZhbHVlc1tpbnB1dC5uYW1lXSA9IGlucHV0LnZhbHVlKSk7XHJcbiAgICByZXR1cm4gaW5wdXRWYWx1ZXM7XHJcbiAgfVxyXG5cclxuICBvcGVuKCkge1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uLnRleHRDb250ZW50ID0gXCJTYXZlXCI7XHJcbiAgICBzdXBlci5vcGVuKCk7XHJcbiAgfVxyXG5cclxuICBjbG9zZSgpIHtcclxuICAgIHRoaXMuX3BvcHVwRm9ybS5yZW1vdmVFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIHRoaXMuX2hhbmRsZVN1Ym1pdEJ1dHRvbik7XHJcbiAgICB0aGlzLl9wb3B1cEZvcm0ucmVzZXQoKTtcclxuICAgIHN1cGVyLmNsb3NlKCk7XHJcbiAgfVxyXG5cclxuICBfaGFuZGxlU3VibWl0QnV0dG9uID0gKGUpID0+IHtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudCA9IFwiU2F2aW5nLi4uXCI7XHJcbiAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0KHRoaXMuX2dldElucHV0VmFsdWVzKCkpO1xyXG4gICAgdGhpcy5jbG9zZSgpO1xyXG4gIH07XHJcblxyXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICAgIHRoaXMuX3BvcHVwRm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIHRoaXMuX2hhbmRsZVN1Ym1pdEJ1dHRvbik7XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBEZWxldGUgZXh0ZW5kcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3RvciwgaGFuZGxlRGVsZXRlQ29uZmlybSkge1xyXG4gICAgc3VwZXIoeyBwb3B1cFNlbGVjdG9yIH0pO1xyXG4gICAgdGhpcy5fcG9wdXBGb3JtID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Zvcm1cIik7XHJcbiAgICB0aGlzLl9oYW5kbGVEZWxldGVDb25maXJtID0gaGFuZGxlRGVsZXRlQ29uZmlybTtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbiA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19idXR0b25cIik7XHJcbiAgfVxyXG5cclxuICBvcGVuKCkge1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uLnRleHRDb250ZW50ID0gXCJTYXZlXCI7XHJcbiAgICBzdXBlci5vcGVuKCk7XHJcbiAgfVxyXG5cclxuICBzZXRFdmVudExpc3RlbmVycygpIHtcclxuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgICB0aGlzLl9wb3B1cEZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZSkgPT4ge1xyXG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgIHRoaXMuX2hhbmRsZURlbGV0ZUNvbmZpcm0oKTtcclxuICAgICAgc3VwZXIuY2xvc2UoKTtcclxuICAgIH0pO1xyXG4gIH1cclxufVxyXG4iLCIvLyAhIHx8LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS18fFxyXG4vLyAhIHx8ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgSW1wb3J0cyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8fFxyXG4vLyAhIHx8LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS18fFxyXG5cclxuaW1wb3J0IENhcmQgZnJvbSBcIi4uL2NvbXBvbmVudHMvQ2FyZC5qc1wiO1xyXG5pbXBvcnQgU2VjdGlvbiBmcm9tIFwiLi4vY29tcG9uZW50cy9TZWN0aW9uLmpzXCI7XHJcbmltcG9ydCBGb3JtVmFsaWRhdG9yIGZyb20gXCIuLi9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanNcIjtcclxuaW1wb3J0IFBvcHVwV2l0aEZvcm0gZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qc1wiO1xyXG5pbXBvcnQgUG9wdXBXaXRoSW1hZ2UgZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanNcIjtcclxuaW1wb3J0IFBvcHVwRGVsZXRlIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwRGVsZXRlLmpzXCI7XHJcbmltcG9ydCBVc2VySW5mbyBmcm9tIFwiLi4vY29tcG9uZW50cy9Vc2VySW5mby5qc1wiO1xyXG5pbXBvcnQgXCIuL2luZGV4LmNzc1wiO1xyXG5pbXBvcnQgQ29uc3RhbnRzIGZyb20gXCIuLi91dGlscy9jb25zdGFudHMuanNcIjtcclxuaW1wb3J0IEFwaSBmcm9tIFwiLi4vY29tcG9uZW50cy9BcGkuanNcIjtcclxuXHJcbi8vICEgfHwtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLXx8XHJcbi8vICEgfHwgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEFQSSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHx8XHJcbi8vICEgfHwtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLXx8XHJcblxyXG5jb25zdCBhcGkgPSBuZXcgQXBpKHtcclxuICBiYXNlVXJsOiBcImh0dHBzOi8vYXJvdW5kLWFwaS5lbi50cmlwbGV0ZW4tc2VydmljZXMuY29tL3YxXCIsXHJcbiAgaGVhZGVyczoge1xyXG4gICAgYXV0aG9yaXphdGlvbjogXCI3ZDliMjZiMC03OGQwLTQyMmEtOTQxYS0wOWM5NWVhMmIwODJcIixcclxuICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxyXG4gIH0sXHJcbn0pO1xyXG5cclxuYXBpLmdldFVzZXJJbmZvKCkudGhlbigodXNlckRhdGEpID0+IHtcclxuICBwcm9maWxlSW5mby5zZXRVc2VySW5mbyh7XHJcbiAgICBuYW1lOiB1c2VyRGF0YS5uYW1lLFxyXG4gICAgZGVzY3JpcHRpb246IHVzZXJEYXRhLmFib3V0LFxyXG4gIH0pO1xyXG59KTtcclxuXHJcbmFwaS5nZXRVc2VySW5mbygpLnRoZW4oKHVzZXJEYXRhKSA9PiB7XHJcbiAgYXZhdGFyLnNldEF0dHJpYnV0ZShcInNyY1wiLCB1c2VyRGF0YS5hdmF0YXIpO1xyXG59KTtcclxuXHJcbmZ1bmN0aW9uIGhhbmRsZVVwZGF0ZVByb2ZpbGUodXNlckRhdGEpIHtcclxuICBhcGkudXBkYXRlUHJvZmlsZSh1c2VyRGF0YSkudGhlbigodXNlckRhdGEpID0+IHtcclxuICAgIHByb2ZpbGVJbmZvLnNldFVzZXJJbmZvKHtcclxuICAgICAgbmFtZTogdXNlckRhdGEubmFtZSxcclxuICAgICAgZGVzY3JpcHRpb246IHVzZXJEYXRhLmFib3V0LFxyXG4gICAgfSk7XHJcbiAgfSk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGhhbmRsZVVwZGF0ZUF2YXRhcih1c2VyRGF0YSkge1xyXG4gIGFwaS51cGRhdGVBdmF0YXIodXNlckRhdGEpO1xyXG4gIGFwaS5nZXRVc2VySW5mbygpLnRoZW4oKHVzZXJkYXRhKSA9PiB7XHJcbiAgICBhdmF0YXIuc2V0QXR0cmlidXRlKFwic3JjXCIsIHVzZXJEYXRhLmF2YXRhcik7XHJcbiAgfSk7XHJcbn1cclxuXHJcbi8vICEgfHwtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLXx8XHJcbi8vICEgfHwgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgRGVjbGFyZWQgVmFyaWFibGVzICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHx8XHJcbi8vICEgfHwtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLXx8XHJcblxyXG4vLyBQcm9maWxlIEVsZW1lbnRzXHJcbmNvbnN0IGVkaXRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2VkaXQtYnV0dG9uXCIpO1xyXG5jb25zdCBhZGRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2FkZC1idXR0b25cIik7XHJcbi8vIEVkaXQgTW9kYWwgRWxlbWVudHNcclxuY29uc3QgZWRpdFBvcHVwID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF90eXBlX2VkaXRcIik7XHJcblxyXG5jb25zdCBwcm9maWxlRm9ybSA9IGRvY3VtZW50LmZvcm1zW1wicHJvZmlsZS1mb3JtXCJdO1xyXG5cclxuY29uc3QgbW9kYWxJbnB1dE5hbWUgPSBlZGl0UG9wdXAucXVlcnlTZWxlY3RvcihcIiNuYW1lXCIpO1xyXG5jb25zdCBtb2RhbElucHV0RGVzY3JpcHRpb24gPSBlZGl0UG9wdXAucXVlcnlTZWxlY3RvcihcIiNkZXNjcmlwdGlvblwiKTtcclxuLy8gQXZhdGFyIE1vZGFsIEVsZW1lbnRzXHJcbmNvbnN0IGF2YXRhciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fYXZhdGFyXCIpO1xyXG5jb25zdCBhdmF0YXJPdmVybGF5ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19hdmF0YXItb3ZlcmxheVwiKTtcclxuY29uc3QgYXZhdGFyUG9wdXAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX3R5cGVfYXZhdGFyXCIpO1xyXG5jb25zdCBtb2RhbElucHV0QXZhdGFyID0gYXZhdGFyUG9wdXAucXVlcnlTZWxlY3RvcihcIiNhdmF0YXItbGlua1wiKTtcclxuY29uc3QgYXZhdGFyRm9ybSA9IGRvY3VtZW50LmZvcm1zW1wiYXZhdGFyLWZvcm1cIl07XHJcbi8vIENhcmQgTW9kYWwgRWxlbWVudHNcclxuY29uc3QgY2FyZEZvcm0gPSBkb2N1bWVudC5mb3Jtc1tcImNhcmQtZm9ybVwiXTtcclxuLy8gQ2FyZCBMaXN0IEVsZW1lbnRzXHJcbmNvbnN0IGNhcmRMaXN0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5nYWxsZXJ5X19jYXJkc1wiKTtcclxuY29uc3QgY2FyZFRlbXBsYXRlID0gY2FyZExpc3RcclxuICAucXVlcnlTZWxlY3RvcihcIiNnYWxsZXJ5LXRlbXBsYXRlXCIpXHJcbiAgLmNvbnRlbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkXCIpO1xyXG5cclxuLy8gISB8fC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tfHxcclxuLy8gISB8fCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIENhcmQgRnVuY3Rpb25zICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfHxcclxuLy8gISB8fC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tfHxcclxuXHJcbmZ1bmN0aW9uIGhhbmRsZUltYWdlQ2xpY2soY2FyZERhdGEpIHtcclxuICBpbWFnZVBvcHVwLm9wZW4oY2FyZERhdGEpO1xyXG59XHJcblxyXG4vLyAhIHx8LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS18fFxyXG4vLyAhIHx8ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgRXZlbnQgTGlzdGVuZXJzICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8fFxyXG4vLyAhIHx8LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS18fFxyXG5cclxuZWRpdEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gIGNvbnN0IHsgbmFtZSwgZGVzY3JpcHRpb24gfSA9IHByb2ZpbGVJbmZvLmdldFVzZXJJbmZvKCk7XHJcbiAgbW9kYWxJbnB1dE5hbWUudmFsdWUgPSBuYW1lO1xyXG4gIG1vZGFsSW5wdXREZXNjcmlwdGlvbi52YWx1ZSA9IGRlc2NyaXB0aW9uO1xyXG4gIGVkaXRQcm9maWxlUG9wdXAub3BlbigpO1xyXG59KTtcclxuXHJcbmF2YXRhck92ZXJsYXkuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICBjb25zb2xlLmxvZyhcIkhlbGxvIGZyb20gYXZhdGFyIGNsaWNrXCIpO1xyXG4gIHVwZGF0ZUF2YXRhclBvcHVwLm9wZW4oKTtcclxufSk7XHJcblxyXG4vLyAhIHx8LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS18fFxyXG4vLyAhIHx8ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIENsYXNzIEluc3RhbnRpYXRpb24gICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8fFxyXG4vLyAhIHx8LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS18fFxyXG5cclxuY29uc3QgY29uc3RhbnRzID0gbmV3IENvbnN0YW50cygpO1xyXG5cclxuY29uc3QgZWRpdEZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihcclxuICBjb25zdGFudHMudmFsaWRhdGlvblNldHRpbmdzLFxyXG4gIHByb2ZpbGVGb3JtXHJcbik7XHJcbmNvbnN0IGFkZEZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihcclxuICBjb25zdGFudHMudmFsaWRhdGlvblNldHRpbmdzLFxyXG4gIGNhcmRGb3JtXHJcbik7XHJcblxyXG5jb25zdCBhdmF0YXJGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IoXHJcbiAgY29uc3RhbnRzLnZhbGlkYXRpb25TZXR0aW5ncyxcclxuICBhdmF0YXJGb3JtXHJcbik7XHJcblxyXG5jb25zdCBwcm9maWxlSW5mbyA9IG5ldyBVc2VySW5mbyh7XHJcbiAgbmFtZTogXCIucHJvZmlsZV9fbmFtZVwiLFxyXG4gIGRlc2NyaXB0aW9uOiBcIi5wcm9maWxlX19kZXNjcmlwdGlvblwiLFxyXG59KTtcclxuXHJcbmNvbnN0IGVkaXRQcm9maWxlUG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybShcIiNlZGl0LXBvcHVwXCIsIGhhbmRsZVVwZGF0ZVByb2ZpbGUpO1xyXG5cclxuY29uc3QgdXBkYXRlQXZhdGFyUG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybShcclxuICBcIiNhdmF0YXItcG9wdXBcIixcclxuICBoYW5kbGVVcGRhdGVBdmF0YXJcclxuKTtcclxuXHJcbmNvbnN0IGltYWdlUG9wdXAgPSBuZXcgUG9wdXBXaXRoSW1hZ2UoXCIjcHJldmlldy1pbWFnZS1wb3B1cFwiKTtcclxuXHJcbmVkaXRGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcclxuYWRkRm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XHJcbmF2YXRhckZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xyXG5cclxuLy8gISB8fC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tfHxcclxuLy8gISB8fCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgR2FsbGVyeSBDcmVhdGlvbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfHxcclxuLy8gISB8fC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tfHxcclxuXHJcbmFwaS5nZXRJbml0aWFsQ2FyZHMoKS50aGVuKChjYXJkcykgPT4ge1xyXG4gIGNvbnN0IGNhcmRHYWxsZXJ5ID0gbmV3IFNlY3Rpb24oXHJcbiAgICB7IGl0ZW1zOiBjYXJkcywgcmVuZGVyZXI6IHJlbmRlckNhcmQgfSxcclxuICAgIFwiLmdhbGxlcnlfX2NhcmRzXCJcclxuICApO1xyXG5cclxuICBmdW5jdGlvbiByZW5kZXJDYXJkKGNhcmREYXRhKSB7XHJcbiAgICBjb25zdCBjYXJkID0gbmV3IENhcmQoXHJcbiAgICAgIHtcclxuICAgICAgICBjYXJkRGF0YSxcclxuXHJcbiAgICAgICAgaGFuZGxlSW1hZ2VDbGljayxcclxuICAgICAgICBoYW5kbGVEZWxldGVCdXR0b24sXHJcbiAgICAgICAgaGFuZGxlQ2FyZExpa2UsXHJcbiAgICAgICAgaGFuZGxlQ2FyZFVubGlrZSxcclxuICAgICAgfSxcclxuICAgICAgY2FyZFRlbXBsYXRlXHJcbiAgICApO1xyXG5cclxuICAgIGZ1bmN0aW9uIGhhbmRsZURlbGV0ZUJ1dHRvbigpIHtcclxuICAgICAgY29uc29sZS5sb2coZG9jdW1lbnQucXVlcnlTZWxlY3RvcihgLm1vZGFsX3R5cGVfZGVsZXRlYCkpO1xyXG4gICAgICBkZWxldGVQb3B1cC5vcGVuKCk7XHJcbiAgICB9XHJcblxyXG4gICAgZnVuY3Rpb24gaGFuZGxlQ2FyZExpa2UoaWQpIHtcclxuICAgICAgYXBpLmxpa2VDYXJkKGlkKTtcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBoYW5kbGVDYXJkVW5saWtlKGlkKSB7XHJcbiAgICAgIGFwaS51bmxpa2VDYXJkKGlkKTtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBoYW5kbGVEZWxldGVTdWJtaXQgPSAoKSA9PiB7XHJcbiAgICAgIGxldCBpZCA9IGNhcmQuZ2V0SWQoKTtcclxuICAgICAgYXBpLnJlbW92ZUNhcmQoaWQpO1xyXG4gICAgICBjYXJkLnJlbW92ZUl0ZW0oKTtcclxuICAgICAgLy8gRm9yIHNvbWUgcmVhc29uLCB3aGVuIHRoaXMgZnVuY3Rpb24gaXMgY2FsbGVkIGNvbnNlY3V0aXZlbHksXHJcbiAgICAgIC8vIGl0IHNhdmVzIHRoZSBjYXJkJ3MgSUQgZnJvbSBlYWNoIHByZXZpb3VzIHRpbWUgaXQgd2FzIGNhbGxlZCxcclxuICAgICAgLy8gc28gaXQgdHJpZXMgdG8gZGVsZXRlIHRob3NlIElEcyBhcyB3ZWxsLlxyXG4gICAgfTtcclxuXHJcbiAgICBjb25zdCBkZWxldGVQb3B1cCA9IG5ldyBQb3B1cERlbGV0ZShcIiNkZWxldGUtcG9wdXBcIiwgaGFuZGxlRGVsZXRlU3VibWl0KTtcclxuXHJcbiAgICByZXR1cm4gY2FyZC5nZXRWaWV3KCk7XHJcbiAgfVxyXG5cclxuICBmdW5jdGlvbiBoYW5kbGVBZGRDYXJkKHsgdGl0bGU6IG5hbWUsIGxpbms6IGxpbmsgfSkge1xyXG4gICAgYXBpLmFkZENhcmQoeyBuYW1lLCBsaW5rIH0pLnRoZW4oKGRhdGEpID0+IHtcclxuICAgICAgY2FyZEdhbGxlcnkuYWRkSXRlbShkYXRhKTtcclxuICAgIH0pO1xyXG4gICAgbmV3Q2FyZFBvcHVwLmNsb3NlKCk7XHJcbiAgfVxyXG5cclxuICBjb25zdCBuZXdDYXJkUG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybShcIiNuZXctY2FyZC1wb3B1cFwiLCBoYW5kbGVBZGRDYXJkKTtcclxuXHJcbiAgYWRkQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICBhZGRGb3JtVmFsaWRhdG9yLnRvZ2dsZUJ1dHRvblN0YXRlKCk7XHJcbiAgICBuZXdDYXJkUG9wdXAub3BlbigpO1xyXG4gIH0pO1xyXG5cclxuICBjYXJkR2FsbGVyeS5yZW5kZXJJdGVtcygpO1xyXG59KTtcclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgQXBpIHtcclxuICBjb25zdHJ1Y3Rvcih7IGJhc2VVcmwsIGhlYWRlcnMgfSkge1xyXG4gICAgdGhpcy5fYmFzZVVybCA9IGJhc2VVcmw7XHJcbiAgICB0aGlzLl9oZWFkZXJzID0gaGVhZGVycztcclxuICAgIHRoaXMuX3Rva2VuID0gaGVhZGVycy5hdXRob3JpemF0aW9uO1xyXG4gIH1cclxuXHJcbiAgZ2V0SW5pdGlhbENhcmRzKCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzYCwge1xyXG4gICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgYXV0aG9yaXphdGlvbjogdGhpcy5fdG9rZW4sXHJcbiAgICAgIH0sXHJcbiAgICB9KVxyXG4gICAgICAudGhlbigocmVzKSA9PiB7XHJcbiAgICAgICAgaWYgKHJlcy5vaykge1xyXG4gICAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcclxuICAgICAgfSlcclxuICAgICAgLmNhdGNoKChlcnIpID0+IHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKGVycik7XHJcbiAgICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgZ2V0VXNlckluZm8oKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWVgLCB7XHJcbiAgICAgIGhlYWRlcnM6IHtcclxuICAgICAgICBhdXRob3JpemF0aW9uOiB0aGlzLl90b2tlbixcclxuICAgICAgfSxcclxuICAgIH0pXHJcbiAgICAgIC50aGVuKChyZXMpID0+IHtcclxuICAgICAgICBpZiAocmVzLm9rKSB7XHJcbiAgICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xyXG4gICAgICB9KVxyXG4gICAgICAuY2F0Y2goKGVycikgPT4ge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcclxuICAgICAgfSk7XHJcbiAgfVxyXG5cclxuICBnZXRBdmF0YXIoKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWVgLCB7XHJcbiAgICAgIGhlYWRlcnM6IHtcclxuICAgICAgICBhdXRob3JpemF0aW9uOiB0aGlzLl90b2tlbixcclxuICAgICAgfSxcclxuICAgIH0pXHJcbiAgICAgIC50aGVuKChyZXMpID0+IHtcclxuICAgICAgICBpZiAocmVzLm9rKSB7XHJcbiAgICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xyXG4gICAgICB9KVxyXG4gICAgICAuY2F0Y2goKGVycikgPT4ge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcclxuICAgICAgfSk7XHJcbiAgfVxyXG5cclxuICBnZXRJZCgpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy86Y2FyZElkYCwge1xyXG4gICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgYXV0aG9yaXphdGlvbjogdGhpcy5fdG9rZW4sXHJcbiAgICAgIH0sXHJcbiAgICB9KVxyXG4gICAgICAudGhlbigocmVzKSA9PiB7XHJcbiAgICAgICAgaWYgKHJlcy5vaykge1xyXG4gICAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcclxuICAgICAgfSlcclxuICAgICAgLmNhdGNoKChlcnIpID0+IHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKGVycik7XHJcbiAgICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgdXBkYXRlUHJvZmlsZSh1c2VyRGF0YSkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L3VzZXJzL21lYCwge1xyXG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcclxuICAgICAgaGVhZGVyczoge1xyXG4gICAgICAgIGF1dGhvcml6YXRpb246IHRoaXMuX3Rva2VuLFxyXG4gICAgICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxyXG4gICAgICB9LFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XHJcbiAgICAgICAgbmFtZTogdXNlckRhdGEubmFtZSxcclxuICAgICAgICBhYm91dDogdXNlckRhdGEuZGVzY3JpcHRpb24sXHJcbiAgICAgIH0pLFxyXG4gICAgfSlcclxuICAgICAgLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICAgIGlmIChyZXMub2spIHtcclxuICAgICAgICAgIHJldHVybiByZXMuanNvbigpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XHJcbiAgICAgIH0pXHJcbiAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcihlcnIpO1xyXG4gICAgICB9KTtcclxuICB9XHJcblxyXG4gIHVwZGF0ZUF2YXRhcihsaW5rKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWUvYXZhdGFyYCwge1xyXG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcclxuICAgICAgaGVhZGVyczoge1xyXG4gICAgICAgIGF1dGhvcml6YXRpb246IHRoaXMuX3Rva2VuLFxyXG4gICAgICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxyXG4gICAgICB9LFxyXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7IGF2YXRhcjogbGluay5hdmF0YXIgfSksXHJcbiAgICB9KVxyXG4gICAgICAudGhlbigocmVzKSA9PiB7XHJcbiAgICAgICAgaWYgKHJlcy5vaykge1xyXG4gICAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcclxuICAgICAgfSlcclxuICAgICAgLmNhdGNoKChlcnIpID0+IHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKGVycik7XHJcbiAgICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgYWRkQ2FyZCh7IG5hbWUsIGxpbmsgfSkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzYCwge1xyXG4gICAgICBtZXRob2Q6IFwiUE9TVFwiLFxyXG4gICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgYXV0aG9yaXphdGlvbjogdGhpcy5fdG9rZW4sXHJcbiAgICAgICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXHJcbiAgICAgIH0sXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICBuYW1lLFxyXG4gICAgICAgIGxpbmssXHJcbiAgICAgIH0pLFxyXG4gICAgfSlcclxuICAgICAgLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICAgIGlmIChyZXMub2spIHtcclxuICAgICAgICAgIHJldHVybiByZXMuanNvbigpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XHJcbiAgICAgIH0pXHJcbiAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcihlcnIpO1xyXG4gICAgICB9KTtcclxuICB9XHJcblxyXG4gIHJlbW92ZUNhcmQoY2FyZElEKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvJHtjYXJkSUR9YCwge1xyXG4gICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXHJcbiAgICAgIGhlYWRlcnM6IHtcclxuICAgICAgICBhdXRob3JpemF0aW9uOiB0aGlzLl90b2tlbixcclxuICAgICAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcclxuICAgICAgICBtZXNzYWdlOiBcIlRoaXMgcG9zdCBoYXMgYmVlbiBkZWxldGVkXCIsXHJcbiAgICAgIH0sXHJcbiAgICB9KVxyXG4gICAgICAudGhlbigocmVzKSA9PiB7XHJcbiAgICAgICAgaWYgKHJlcy5vaykge1xyXG4gICAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcclxuICAgICAgfSlcclxuICAgICAgLmNhdGNoKChlcnIpID0+IHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKGVycik7XHJcbiAgICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgbGlrZUNhcmQoY2FyZElkKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvJHtjYXJkSWR9L2xpa2VzYCwge1xyXG4gICAgICBtZXRob2Q6IFwiUFVUXCIsXHJcbiAgICAgIGhlYWRlcnM6IHtcclxuICAgICAgICBhdXRob3JpemF0aW9uOiB0aGlzLl90b2tlbixcclxuICAgICAgfSxcclxuICAgIH0pXHJcbiAgICAgIC50aGVuKChyZXMpID0+IHtcclxuICAgICAgICBpZiAocmVzLm9rKSB7XHJcbiAgICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xyXG4gICAgICB9KVxyXG4gICAgICAuY2F0Y2goKGVycikgPT4ge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcclxuICAgICAgfSk7XHJcbiAgfVxyXG5cclxuICB1bmxpa2VDYXJkKGNhcmRJZCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzLyR7Y2FyZElkfS9saWtlc2AsIHtcclxuICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxyXG4gICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgYXV0aG9yaXphdGlvbjogdGhpcy5fdG9rZW4sXHJcbiAgICAgIH0sXHJcbiAgICB9KVxyXG4gICAgICAudGhlbigocmVzKSA9PiB7XHJcbiAgICAgICAgaWYgKHJlcy5vaykge1xyXG4gICAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcclxuICAgICAgfSlcclxuICAgICAgLmNhdGNoKChlcnIpID0+IHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKGVycik7XHJcbiAgICAgIH0pO1xyXG4gIH1cclxufVxyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBDb25zdGFudHMge1xyXG4gIGNvbnN0cnVjdG9yKCkge1xyXG4gICAgLy8gISB8fC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tfHxcclxuICAgIC8vICEgfHwgICAgICAgICAgICAgICAgICAgICAgICAgICAgRm9ybSBWYWxpZGF0aW9uIFNlbGVjdG9ycyAgICAgICAgICAgICAgICAgICAgICAgICAgIHx8XHJcbiAgICAvLyAhIHx8LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS18fFxyXG5cclxuICAgIHRoaXMudmFsaWRhdGlvblNldHRpbmdzID0ge1xyXG4gICAgICBmb3JtU2VsZWN0b3I6IFwiLm1vZGFsX19mb3JtXCIsXHJcbiAgICAgIGlucHV0U2VsZWN0b3I6IFwiLm1vZGFsX19pbnB1dFwiLFxyXG4gICAgICBzdWJtaXRCdXR0b25TZWxlY3RvcjogXCIubW9kYWxfX2J1dHRvblwiLFxyXG4gICAgICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiBcIm1vZGFsX19idXR0b25fZGlzYWJsZWRcIixcclxuICAgICAgaW5wdXRFcnJvckNsYXNzOiBcIm1vZGFsX19pbnB1dF90eXBlX2Vycm9yXCIsXHJcbiAgICAgIGVycm9yQ2xhc3M6IFwibW9kYWxfX2Vycm9yX3Zpc2libGVcIixcclxuICAgIH07XHJcbiAgfVxyXG59XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFVzZXJJbmZvIHtcclxuICBjb25zdHJ1Y3Rvcih7IG5hbWUsIGRlc2NyaXB0aW9uIH0pIHtcclxuICAgIHRoaXMuX25hbWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKG5hbWUpO1xyXG4gICAgdGhpcy5fZGVzY3JpcHRpb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGRlc2NyaXB0aW9uKTtcclxuICB9XHJcblxyXG4gIGdldFVzZXJJbmZvKCkge1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgbmFtZTogdGhpcy5fbmFtZS50ZXh0Q29udGVudCxcclxuICAgICAgZGVzY3JpcHRpb246IHRoaXMuX2Rlc2NyaXB0aW9uLnRleHRDb250ZW50LFxyXG4gICAgfTtcclxuICB9XHJcblxyXG4gIHNldFVzZXJJbmZvKHsgbmFtZSwgZGVzY3JpcHRpb24gfSkge1xyXG4gICAgdGhpcy5fbmFtZS50ZXh0Q29udGVudCA9IG5hbWU7XHJcbiAgICB0aGlzLl9kZXNjcmlwdGlvbi50ZXh0Q29udGVudCA9IGRlc2NyaXB0aW9uO1xyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aEltYWdlIGV4dGVuZHMgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcclxuICAgIHN1cGVyKHsgcG9wdXBTZWxlY3RvciB9KTtcclxuICAgIHRoaXMuX3ByZXZpZXdJbWFnZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX3ByZXZpZXctaW1hZ2VcIik7XHJcbiAgICB0aGlzLl9wcmV2aWV3TmFtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX3ByZXZpZXctbmFtZVwiKTtcclxuICB9XHJcblxyXG4gIG9wZW4oeyBuYW1lLCBsaW5rIH0pIHtcclxuICAgIHRoaXMuX3ByZXZpZXdJbWFnZS5zcmMgPSBsaW5rO1xyXG4gICAgdGhpcy5fcHJldmlld0ltYWdlLmFsdCA9IG5hbWU7XHJcbiAgICB0aGlzLl9wcmV2aWV3TmFtZS50ZXh0Q29udGVudCA9IG5hbWU7XHJcbiAgICBzdXBlci5vcGVuKCk7XHJcbiAgfVxyXG59XHJcbiJdLCJuYW1lcyI6WyJDYXJkIiwiY29uc3RydWN0b3IiLCJfcmVmIiwiY2FyZFNlbGVjdG9yIiwiY2FyZERhdGEiLCJoYW5kbGVJbWFnZUNsaWNrIiwiaGFuZGxlRGVsZXRlQnV0dG9uIiwiaGFuZGxlQ2FyZExpa2UiLCJoYW5kbGVDYXJkVW5saWtlIiwidGhpcyIsIl9jYXJkU2VsZWN0b3IiLCJfbmFtZSIsIm5hbWUiLCJfbGluayIsImxpbmsiLCJfaWQiLCJfaGFuZGxlSW1hZ2VDbGljayIsIl9oYW5kbGVEZWxldGVCdXR0b24iLCJfaGFuZGxlQ2FyZExpa2UiLCJfaGFuZGxlQ2FyZFVubGlrZSIsIl9nZXRUZW1wbGF0ZSIsImNsb25lTm9kZSIsImdldElkIiwicmVtb3ZlSXRlbSIsIl9lbGVtZW50IiwicmVtb3ZlIiwiX2hhbmRsZUxpa2VCdXR0b24iLCJfbGlrZUJ1dHRvbiIsImNsYXNzTGlzdCIsImNvbnRhaW5zIiwiYWRkIiwiX3NldEV2ZW50TGlzdGVuZXJzIiwiYWRkRXZlbnRMaXN0ZW5lciIsIl9kZWxldGVCdXR0b24iLCJfY2FyZEltYWdlIiwiZ2V0VmlldyIsInF1ZXJ5U2VsZWN0b3IiLCJfY2FyZE5hbWVDb250ZW50Iiwic2V0QXR0cmlidXRlIiwidGV4dENvbnRlbnQiLCJTZWN0aW9uIiwiY29udGFpbmVyU2VsZWN0b3IiLCJpdGVtcyIsInJlbmRlcmVyIiwiX2l0ZW1zIiwiX3JlbmRlcmVyIiwiX2NvbnRhaW5lciIsImRvY3VtZW50IiwicmVuZGVySXRlbXMiLCJmb3JFYWNoIiwiYWRkSXRlbSIsImNhcmRFbGVtZW50IiwicHJlcGVuZCIsIkZvcm1WYWxpZGF0b3IiLCJzZXR0aW5ncyIsImZvcm1FbGVtZW50IiwiX2lucHV0U2VsZWN0b3IiLCJpbnB1dFNlbGVjdG9yIiwiX3N1Ym1pdEJ1dHRvblNlbGVjdG9yIiwic3VibWl0QnV0dG9uU2VsZWN0b3IiLCJfaW5hY3RpdmVCdXR0b25DbGFzcyIsImluYWN0aXZlQnV0dG9uQ2xhc3MiLCJfaW5wdXRFcnJvckNsYXNzIiwiaW5wdXRFcnJvckNsYXNzIiwiX2Vycm9yQ2xhc3MiLCJlcnJvckNsYXNzIiwiX2Zvcm1FbGVtZW50IiwiX3N1Ym1pdEJ1dHRvbiIsIl9pbnB1dExpc3QiLCJBcnJheSIsImZyb20iLCJxdWVyeVNlbGVjdG9yQWxsIiwiX3Nob3dJbnB1dEVycm9yIiwiaW5wdXRFbGVtZW50IiwiZXJyb3JFbGVtZW50IiwiaWQiLCJ2YWxpZGF0aW9uTWVzc2FnZSIsIl9oaWRlSW5wdXRFcnJvciIsIl9oYXNWYWxpZElucHV0IiwiZXZlcnkiLCJpbnB1dEVsIiwidmFsaWRpdHkiLCJ2YWxpZCIsInRvZ2dsZUJ1dHRvblN0YXRlIiwiX2Rpc2FibGVCdXR0b24iLCJfZW5hYmxlQnV0dG9uIiwiX2NoZWNrRm9ybVZhbGlkaXR5IiwiZm91bmRJbnZhbGlkIiwiZGlzYWJsZWQiLCJjaGVja0lucHV0VmFsaWRpdHkiLCJlbmFibGVWYWxpZGF0aW9uIiwiZSIsInByZXZlbnREZWZhdWx0IiwiUG9wdXAiLCJwb3B1cFNlbGVjdG9yIiwiX3BvcHVwRWxlbWVudCIsIl9jbG9zZUJ1dHRvbiIsIm9wZW4iLCJzZXRFdmVudExpc3RlbmVycyIsImNsb3NlIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsIl9oYW5kbGVDbG9zZUJ1dHRvbiIsIl9oYW5kbGVDbGlja0Nsb3NlIiwiX2hhbmRsZUVzY0Nsb3NlIiwidGFyZ2V0Iiwia2V5IiwiUG9wdXBXaXRoRm9ybSIsImhhbmRsZUZvcm1TdWJtaXQiLCJzdXBlciIsIl9wb3B1cEZvcm0iLCJfaGFuZGxlRm9ybVN1Ym1pdCIsIl9pbnB1dHMiLCJfZ2V0SW5wdXRWYWx1ZXMiLCJpbnB1dFZhbHVlcyIsImlucHV0IiwidmFsdWUiLCJfaGFuZGxlU3VibWl0QnV0dG9uIiwicmVzZXQiLCJQb3B1cERlbGV0ZSIsImhhbmRsZURlbGV0ZUNvbmZpcm0iLCJfaGFuZGxlRGVsZXRlQ29uZmlybSIsImFwaSIsImJhc2VVcmwiLCJoZWFkZXJzIiwiX2Jhc2VVcmwiLCJfaGVhZGVycyIsIl90b2tlbiIsImF1dGhvcml6YXRpb24iLCJnZXRJbml0aWFsQ2FyZHMiLCJmZXRjaCIsInRoZW4iLCJyZXMiLCJvayIsImpzb24iLCJQcm9taXNlIiwicmVqZWN0Iiwic3RhdHVzIiwiY2F0Y2giLCJlcnIiLCJjb25zb2xlIiwiZXJyb3IiLCJnZXRVc2VySW5mbyIsImdldEF2YXRhciIsInVwZGF0ZVByb2ZpbGUiLCJ1c2VyRGF0YSIsIm1ldGhvZCIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5IiwiYWJvdXQiLCJkZXNjcmlwdGlvbiIsInVwZGF0ZUF2YXRhciIsImF2YXRhciIsImFkZENhcmQiLCJfcmVmMiIsInJlbW92ZUNhcmQiLCJjYXJkSUQiLCJtZXNzYWdlIiwibGlrZUNhcmQiLCJjYXJkSWQiLCJ1bmxpa2VDYXJkIiwicHJvZmlsZUluZm8iLCJzZXRVc2VySW5mbyIsImVkaXRCdXR0b24iLCJhZGRCdXR0b24iLCJlZGl0UG9wdXAiLCJwcm9maWxlRm9ybSIsImZvcm1zIiwibW9kYWxJbnB1dE5hbWUiLCJtb2RhbElucHV0RGVzY3JpcHRpb24iLCJhdmF0YXJPdmVybGF5IiwiYXZhdGFyRm9ybSIsImNhcmRGb3JtIiwiY2FyZFRlbXBsYXRlIiwiY29udGVudCIsImltYWdlUG9wdXAiLCJlZGl0UHJvZmlsZVBvcHVwIiwibG9nIiwidXBkYXRlQXZhdGFyUG9wdXAiLCJjb25zdGFudHMiLCJ2YWxpZGF0aW9uU2V0dGluZ3MiLCJmb3JtU2VsZWN0b3IiLCJlZGl0Rm9ybVZhbGlkYXRvciIsImFkZEZvcm1WYWxpZGF0b3IiLCJhdmF0YXJGb3JtVmFsaWRhdG9yIiwiX2Rlc2NyaXB0aW9uIiwidXNlcmRhdGEiLCJfcHJldmlld0ltYWdlIiwiX3ByZXZpZXdOYW1lIiwic3JjIiwiYWx0IiwiY2FyZHMiLCJjYXJkR2FsbGVyeSIsImNhcmQiLCJkZWxldGVQb3B1cCIsImhhbmRsZURlbGV0ZVN1Ym1pdCIsIm5ld0NhcmRQb3B1cCIsInRpdGxlIiwiZGF0YSJdLCJzb3VyY2VSb290IjoiIn0=