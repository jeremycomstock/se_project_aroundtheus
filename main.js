!function(){"use strict";class e{constructor(e,t){let{cardData:s,handleImageClick:r,handleDeleteButton:n,handleCardLike:i,handleCardUnlike:o}=e;this._cardSelector=t,this._name=s.name,this._link=s.link,this._id=s._id,this._handleImageClick=r,this._handleDeleteButton=n,this._handleCardLike=i,this._handleCardUnlike=o}_getTemplate(){return this._cardSelector.cloneNode(!0)}getId(){return this._id}removeItem(){this._element.remove()}_handleLikeButton=()=>{this._likeButton.classList.contains("card__like-button_active")?this._likeButton.classList.contains("card__like-button_active")&&(this._handleCardUnlike(this._id),this._likeButton.classList.remove("card__like-button_active")):(this._handleCardLike(this._id),this._likeButton.classList.add("card__like-button_active"))};_setEventListeners(){this._likeButton.addEventListener("click",this._handleLikeButton),this._deleteButton.addEventListener("click",this._handleDeleteButton),this._cardImage.addEventListener("click",(()=>{this._handleImageClick({name:this._name,link:this._link})}))}getView(){return this._element=this._getTemplate(),this._cardImage=this._element.querySelector(".card__image"),this._likeButton=this._element.querySelector(".card__like-button"),this._deleteButton=this._element.querySelector(".card__delete-button"),this._cardNameContent=this._element.querySelector(".card__name"),this._cardImage.setAttribute("src",this._link),this._cardImage.setAttribute("alt",this._name),this._cardNameContent.textContent=this._name,this._setEventListeners(),this._element}}class t{constructor(e,t){let{items:s,renderer:r}=e;this._items=s,this._renderer=r,this._container=document.querySelector(t)}renderItems(){this._items.forEach((e=>{this.addItem(e)}))}addItem(e){const t=this._renderer(e);this._container.prepend(t)}}class s{constructor(e,t){this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass,this._formElement=t,this._submitButton=this._formElement.querySelector(this._submitButtonSelector),this._inputList=Array.from(this._formElement.querySelectorAll(this._inputSelector))}_showInputError(e,t){const s=this._formElement.querySelector(`#${t.id}-error`);t.classList.add(this._inputErrorClass),s.textContent=t.validationMessage,s.classList.add(this._errorClass)}_hideInputError(e,t){const s=this._formElement.querySelector(`#${t.id}-error`);t.classList.remove(this._inputErrorClass),s.textContent="",s.classList.remove(this._errorClass)}_hasValidInput(){return!this._inputList.every((e=>e.validity.valid))}toggleButtonState(){this._hasValidInput()?this._disableButton():this._enableButton()}_checkFormValidity(e){this._inputList.forEach((t=>(t.validity.valid||(e=!0),e)))}_disableButton(){this._submitButton.classList.add(this._inactiveButtonClass),this._submitButton.disabled=!0}_enableButton(){this._submitButton.classList.remove(this._inactiveButtonClass),this._submitButton.disabled=!1}checkInputValidity(e,t){t.validity.valid?this._hideInputError(e,t):this._showInputError(e,t)}_setEventListeners(){this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this.checkInputValidity(this._formElement,e),this.toggleButtonState()}))}))}enableValidation(){this._formElement.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}}class r{constructor(e){let{popupSelector:t}=e;this._popupElement=document.querySelector(t),this._closeButton=this._popupElement.querySelector(".modal__close")}open(){this._submitButton.textContent="Save",this._popupElement.classList.add("modal_opened"),this.setEventListeners()}close(){this._closeButton.removeEventListener("click",this._handleCloseButton),this._popupElement.removeEventListener("click",this._handleClickClose),this._popupElement.classList.remove("modal_opened"),document.removeEventListener("keydown",this._handleEscClose)}_handleCloseButton=()=>{this.close()};_handleClickClose=e=>{e.target==this._popupElement&&this.close()};_handleEscClose=e=>{"Escape"===e.key&&this.close()};setEventListeners(){this._closeButton.addEventListener("click",this._handleCloseButton),this._popupElement.addEventListener("click",this._handleClickClose),document.addEventListener("keydown",this._handleEscClose)}}class n extends r{constructor(e,t){super({popupSelector:e}),this._popupForm=this._popupElement.querySelector(".modal__form"),this._handleFormSubmit=t,this._inputs=this._popupForm.querySelectorAll(".modal__input"),this._submitButton=this._popupElement.querySelector(".modal__button")}_getInputValues(){const e={};return this._inputs.forEach((t=>e[t.name]=t.value)),e}close(){this._popupForm.removeEventListener("submit",this._handleSubmitButton),this._popupForm.reset(),super.close()}_handleSubmitButton=e=>{this._submitButton.textContent="Saving...",e.preventDefault(),this._handleFormSubmit(this._getInputValues()),this.close()};setEventListeners(){super.setEventListeners(),this._popupForm.addEventListener("submit",this._handleSubmitButton)}}class i extends r{constructor(e,t){super({popupSelector:e}),this._popupForm=this._popupElement.querySelector(".modal__form"),this._handleDeleteConfirm=t}setEventListeners(){super.setEventListeners(),this._popupForm.addEventListener("submit",(e=>{e.preventDefault(),this._handleDeleteConfirm(),super.close()}))}}const o=new class{constructor(e){let{baseUrl:t,headers:s}=e;this._baseUrl=t,this._headers=s,this._token=s.authorization}getInitialCards(){return fetch(`${this._baseUrl}/cards`,{headers:{authorization:this._token}}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`))).catch((e=>{console.error(e)}))}getUserInfo(){return fetch(`${this._baseUrl}/users/me`,{headers:{authorization:this._token}}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`))).catch((e=>{console.error(e)}))}getAvatar(){return fetch(`${this._baseUrl}/users/me`,{headers:{authorization:this._token}}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`))).catch((e=>{console.error(e)}))}getId(){return fetch(`${this._baseUrl}/cards/:cardId`,{headers:{authorization:this._token}}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`))).catch((e=>{console.error(e)}))}updateProfile(e){return fetch(`${this._baseUrl}/users/me`,{method:"PATCH",headers:{authorization:this._token,"Content-Type":"application/json"},body:JSON.stringify({name:e.name,about:e.description})}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`))).catch((e=>{console.error(e)}))}updateAvatar(e){return fetch(`${this._baseUrl}/users/me/avatar`,{method:"PATCH",headers:{authorization:this._token,"Content-Type":"application/json"},body:JSON.stringify({avatar:e.avatar})}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`))).catch((e=>{console.error(e)}))}addCard(e){let{name:t,link:s}=e;return fetch(`${this._baseUrl}/cards`,{method:"POST",headers:{authorization:this._token,"Content-Type":"application/json"},body:JSON.stringify({name:t,link:s})}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`))).catch((e=>{console.error(e)}))}removeCard(e){return fetch(`${this._baseUrl}/cards/${e}`,{method:"DELETE",headers:{authorization:this._token,"Content-Type":"application/json",message:"This post has been deleted"}}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`))).catch((e=>{console.error(e)}))}likeCard(e){return fetch(`${this._baseUrl}/cards/${e}/likes`,{method:"PUT",headers:{authorization:this._token}}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`))).catch((e=>{console.error(e)}))}unlikeCard(e){return fetch(`${this._baseUrl}/cards/${e}/likes`,{method:"DELETE",headers:{authorization:this._token}}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`))).catch((e=>{console.error(e)}))}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"7d9b26b0-78d0-422a-941a-09c95ea2b082","Content-Type":"application/json"}});o.getUserInfo().then((e=>{y.setUserInfo({name:e.name,description:e.about})})),o.getUserInfo().then((e=>{_.setAttribute("src",e.avatar)}));const a=document.querySelector(".profile__edit-button"),l=document.querySelector(".profile__add-button"),c=document.querySelector(".modal_type_edit"),h=document.forms["profile-form"],u=c.querySelector("#name"),d=c.querySelector("#description"),_=document.querySelector(".profile__avatar"),m=document.querySelector(".profile__avatar-overlay"),p=(document.querySelector(".modal_type_avatar").querySelector("#avatar-link"),document.forms["avatar-form"]),v=document.forms["card-form"],k=document.querySelector(".gallery__cards").querySelector("#gallery-template").content.querySelector(".card");function E(e){B.open(e)}a.addEventListener("click",(()=>{const{name:e,description:t}=y.getUserInfo();u.value=e,d.value=t,g.open()})),m.addEventListener("click",(()=>{console.log("Hello from avatar click"),L.open()}));const b=new class{constructor(){this.validationSettings={formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__button",inactiveButtonClass:"modal__button_disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__error_visible"}}},C=new s(b.validationSettings,h),f=new s(b.validationSettings,v),S=new s(b.validationSettings,p),y=new class{constructor(e){let{name:t,description:s}=e;this._name=document.querySelector(t),this._description=document.querySelector(s)}getUserInfo(){return{name:this._name.textContent,description:this._description.textContent}}setUserInfo(e){let{name:t,description:s}=e;this._name.textContent=t,this._description.textContent=s}}({name:".profile__name",description:".profile__description"}),g=new n("#edit-popup",(function(e){o.updateProfile(e).then((e=>{y.setUserInfo({name:e.name,description:e.about})}))})),L=new n("#avatar-popup",(function(e){o.updateAvatar(e),o.getUserInfo().then((t=>{_.setAttribute("src",e.avatar)}))})),B=new class extends r{constructor(e){super({popupSelector:e}),this._previewImage=document.querySelector(".modal__preview-image"),this._previewName=document.querySelector(".modal__preview-name")}open(e){let{name:t,link:s}=e;this._previewImage.src=s,this._previewImage.alt=t,this._previewName.textContent=t,super.open()}}("#preview-image-popup");C.enableValidation(),f.enableValidation(),S.enableValidation(),o.getInitialCards().then((s=>{const r=new t({items:s,renderer:function(t){const s=new e({cardData:t,handleImageClick:E,handleDeleteButton:function(){r.open()},handleCardLike:function(e){o.likeCard(e)},handleCardUnlike:function(e){o.unlikeCard(e)}},k),r=new i("#delete-popup",(()=>{let e=s.getId();o.removeCard(e),s.removeItem()}));return s.getView()}},".gallery__cards"),a=new n("#new-card-popup",(function(e){let{title:t,link:s}=e;o.addCard({name:t,link:s}).then((e=>{r.addItem(e)})),a.close()}));l.addEventListener("click",(()=>{f.toggleButtonState(),a.open()})),r.renderItems()}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUV0Q3FGLEVBQWtCNUYsbUJBQ2xCNkYsRUFBaUI3RixtQkFDakI4RixFQUFvQjlGLG1CQU1wQitCLEVBQUlPLGtCQUFrQkUsTUFBTTZELElBQzFCLE1BQU1DLEVBQWMsSUFBSXhKLEVBQ3RCLENBQUVFLE1BQU9xSixFQUFPcEosU0FJbEIsU0FBb0J2QyxHQUNsQixNQUFNNkwsRUFBTyxJQUFJak0sRUFDZixDQUNFSSxXQUVBQyxtQkFDQUMsbUJBT0osV0FDRTRMLEVBQVlqRyxNQUNkLEVBUkkxRixlQVVKLFNBQXdCb0UsR0FDdEI4QyxFQUFJcUMsU0FBU25GLEVBQ2YsRUFYSW5FLGlCQWFKLFNBQTBCbUUsR0FDeEI4QyxFQUFJdUMsV0FBV3JGLEVBQ2pCLEdBYkVrRyxHQXdCSXFCLEVBQWMsSUFBSTVFLEVBQVksaUJBVFQ2RSxLQUN6QixJQUFJeEgsRUFBS3NILEVBQUszSyxRQUNkbUcsRUFBSWtDLFdBQVdoRixHQUNmc0gsRUFBSzFLLFlBQVksSUFRbkIsT0FBTzBLLEVBQUs5SixTQUNkLEdBeENFLG1CQWlESWlLLEVBQWUsSUFBSTFGLEVBQWMsbUJBUHZDLFNBQXNCeEcsR0FBOEIsSUFBM0JtTSxNQUFPekwsRUFBTUUsS0FBTUEsR0FBTVosRUFDaER1SCxFQUFJZ0MsUUFBUSxDQUFFN0ksT0FBTUUsU0FBUW9ILE1BQU1vRSxJQUNoQ04sRUFBWTlJLFFBQVFvSixFQUFLLElBRTNCRixFQUFhakcsT0FDZixJQUlBaUUsRUFBVXBJLGlCQUFpQixTQUFTLEtBQ2xDdUosRUFBaUJwRyxvQkFDakJpSCxFQUFhbkcsTUFBTSxJQUdyQitGLEVBQVloSixhQUFhLEciLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9DYXJkLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1NlY3Rpb24uanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Qb3B1cC5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1BvcHVwRGVsZXRlLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9wYWdlcy9pbmRleC5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9BcGkuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL3V0aWxzL2NvbnN0YW50cy5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Vc2VySW5mby5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgZGVmYXVsdCBjbGFzcyBDYXJkIHtcclxuICBjb25zdHJ1Y3RvcihcclxuICAgIHtcclxuICAgICAgY2FyZERhdGEsXHJcbiAgICAgIGhhbmRsZUltYWdlQ2xpY2ssXHJcbiAgICAgIGhhbmRsZURlbGV0ZUJ1dHRvbixcclxuICAgICAgaGFuZGxlQ2FyZExpa2UsXHJcbiAgICAgIGhhbmRsZUNhcmRVbmxpa2UsXHJcbiAgICB9LFxyXG4gICAgY2FyZFNlbGVjdG9yXHJcbiAgKSB7XHJcbiAgICB0aGlzLl9jYXJkU2VsZWN0b3IgPSBjYXJkU2VsZWN0b3I7XHJcbiAgICB0aGlzLl9uYW1lID0gY2FyZERhdGEubmFtZTtcclxuICAgIHRoaXMuX2xpbmsgPSBjYXJkRGF0YS5saW5rO1xyXG4gICAgdGhpcy5faWQgPSBjYXJkRGF0YS5faWQ7XHJcblxyXG4gICAgdGhpcy5faGFuZGxlSW1hZ2VDbGljayA9IGhhbmRsZUltYWdlQ2xpY2s7XHJcbiAgICB0aGlzLl9oYW5kbGVEZWxldGVCdXR0b24gPSBoYW5kbGVEZWxldGVCdXR0b247XHJcbiAgICB0aGlzLl9oYW5kbGVDYXJkTGlrZSA9IGhhbmRsZUNhcmRMaWtlO1xyXG4gICAgdGhpcy5faGFuZGxlQ2FyZFVubGlrZSA9IGhhbmRsZUNhcmRVbmxpa2U7XHJcbiAgfVxyXG5cclxuICBfZ2V0VGVtcGxhdGUoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5fY2FyZFNlbGVjdG9yLmNsb25lTm9kZSh0cnVlKTtcclxuICB9XHJcblxyXG4gIGdldElkKCkge1xyXG4gICAgcmV0dXJuIHRoaXMuX2lkO1xyXG4gIH1cclxuXHJcbiAgcmVtb3ZlSXRlbSgpIHtcclxuICAgIHRoaXMuX2VsZW1lbnQucmVtb3ZlKCk7XHJcbiAgfVxyXG5cclxuICBfaGFuZGxlTGlrZUJ1dHRvbiA9ICgpID0+IHtcclxuICAgIGlmICghdGhpcy5fbGlrZUJ1dHRvbi5jbGFzc0xpc3QuY29udGFpbnMoXCJjYXJkX19saWtlLWJ1dHRvbl9hY3RpdmVcIikpIHtcclxuICAgICAgdGhpcy5faGFuZGxlQ2FyZExpa2UodGhpcy5faWQpO1xyXG4gICAgICB0aGlzLl9saWtlQnV0dG9uLmNsYXNzTGlzdC5hZGQoXCJjYXJkX19saWtlLWJ1dHRvbl9hY3RpdmVcIik7XHJcbiAgICB9IGVsc2UgaWYgKFxyXG4gICAgICB0aGlzLl9saWtlQnV0dG9uLmNsYXNzTGlzdC5jb250YWlucyhcImNhcmRfX2xpa2UtYnV0dG9uX2FjdGl2ZVwiKVxyXG4gICAgKSB7XHJcbiAgICAgIHRoaXMuX2hhbmRsZUNhcmRVbmxpa2UodGhpcy5faWQpO1xyXG4gICAgICB0aGlzLl9saWtlQnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUoXCJjYXJkX19saWtlLWJ1dHRvbl9hY3RpdmVcIik7XHJcbiAgICB9XHJcbiAgfTtcclxuXHJcbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgdGhpcy5fbGlrZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgdGhpcy5faGFuZGxlTGlrZUJ1dHRvbik7XHJcbiAgICB0aGlzLl9kZWxldGVCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIHRoaXMuX2hhbmRsZURlbGV0ZUJ1dHRvbik7XHJcbiAgICB0aGlzLl9jYXJkSW1hZ2UuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgICAgdGhpcy5faGFuZGxlSW1hZ2VDbGljayh7XHJcbiAgICAgICAgbmFtZTogdGhpcy5fbmFtZSxcclxuICAgICAgICBsaW5rOiB0aGlzLl9saW5rLFxyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgZ2V0VmlldygpIHtcclxuICAgIHRoaXMuX2VsZW1lbnQgPSB0aGlzLl9nZXRUZW1wbGF0ZSgpO1xyXG4gICAgdGhpcy5fY2FyZEltYWdlID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2ltYWdlXCIpO1xyXG4gICAgdGhpcy5fbGlrZUJ1dHRvbiA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19saWtlLWJ1dHRvblwiKTtcclxuICAgIHRoaXMuX2RlbGV0ZUJ1dHRvbiA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19kZWxldGUtYnV0dG9uXCIpO1xyXG4gICAgdGhpcy5fY2FyZE5hbWVDb250ZW50ID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX25hbWVcIik7XHJcblxyXG4gICAgdGhpcy5fY2FyZEltYWdlLnNldEF0dHJpYnV0ZShcInNyY1wiLCB0aGlzLl9saW5rKTtcclxuICAgIHRoaXMuX2NhcmRJbWFnZS5zZXRBdHRyaWJ1dGUoXCJhbHRcIiwgdGhpcy5fbmFtZSk7XHJcblxyXG4gICAgdGhpcy5fY2FyZE5hbWVDb250ZW50LnRleHRDb250ZW50ID0gdGhpcy5fbmFtZTtcclxuXHJcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xyXG4gICAgcmV0dXJuIHRoaXMuX2VsZW1lbnQ7XHJcbiAgfVxyXG59XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFNlY3Rpb24ge1xyXG4gIGNvbnN0cnVjdG9yKHsgaXRlbXMsIHJlbmRlcmVyIH0sIGNvbnRhaW5lclNlbGVjdG9yKSB7XHJcbiAgICB0aGlzLl9pdGVtcyA9IGl0ZW1zO1xyXG4gICAgdGhpcy5fcmVuZGVyZXIgPSByZW5kZXJlcjtcclxuICAgIHRoaXMuX2NvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoY29udGFpbmVyU2VsZWN0b3IpO1xyXG4gIH1cclxuXHJcbiAgcmVuZGVySXRlbXMoKSB7XHJcbiAgICB0aGlzLl9pdGVtcy5mb3JFYWNoKChjYXJkRGF0YSkgPT4ge1xyXG4gICAgICB0aGlzLmFkZEl0ZW0oY2FyZERhdGEpO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBhZGRJdGVtKGNhcmREYXRhKSB7XHJcbiAgICBjb25zdCBjYXJkRWxlbWVudCA9IHRoaXMuX3JlbmRlcmVyKGNhcmREYXRhKTtcclxuICAgIHRoaXMuX2NvbnRhaW5lci5wcmVwZW5kKGNhcmRFbGVtZW50KTtcclxuICB9XHJcbn1cclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgRm9ybVZhbGlkYXRvciB7XHJcbiAgY29uc3RydWN0b3Ioc2V0dGluZ3MsIGZvcm1FbGVtZW50KSB7XHJcbiAgICB0aGlzLl9pbnB1dFNlbGVjdG9yID0gc2V0dGluZ3MuaW5wdXRTZWxlY3RvcjtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvblNlbGVjdG9yID0gc2V0dGluZ3Muc3VibWl0QnV0dG9uU2VsZWN0b3I7XHJcbiAgICB0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzID0gc2V0dGluZ3MuaW5hY3RpdmVCdXR0b25DbGFzcztcclxuICAgIHRoaXMuX2lucHV0RXJyb3JDbGFzcyA9IHNldHRpbmdzLmlucHV0RXJyb3JDbGFzcztcclxuICAgIHRoaXMuX2Vycm9yQ2xhc3MgPSBzZXR0aW5ncy5lcnJvckNsYXNzO1xyXG5cclxuICAgIHRoaXMuX2Zvcm1FbGVtZW50ID0gZm9ybUVsZW1lbnQ7XHJcblxyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcclxuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3JcclxuICAgICk7XHJcblxyXG4gICAgdGhpcy5faW5wdXRMaXN0ID0gQXJyYXkuZnJvbShcclxuICAgICAgdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvckFsbCh0aGlzLl9pbnB1dFNlbGVjdG9yKVxyXG4gICAgKTtcclxuICB9XHJcblxyXG4gIF9zaG93SW5wdXRFcnJvcihmb3JtRWxlbWVudCwgaW5wdXRFbGVtZW50KSB7XHJcbiAgICBjb25zdCBlcnJvckVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gICAgICBgIyR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmBcclxuICAgICk7XHJcbiAgICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xyXG4gICAgZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gaW5wdXRFbGVtZW50LnZhbGlkYXRpb25NZXNzYWdlO1xyXG4gICAgZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5fZXJyb3JDbGFzcyk7XHJcbiAgfVxyXG5cclxuICBfaGlkZUlucHV0RXJyb3IoZm9ybUVsZW1lbnQsIGlucHV0RWxlbWVudCkge1xyXG4gICAgY29uc3QgZXJyb3JFbGVtZW50ID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcclxuICAgICAgYCMke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgXHJcbiAgICApO1xyXG4gICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcclxuICAgIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IFwiXCI7XHJcbiAgICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9lcnJvckNsYXNzKTtcclxuICB9XHJcblxyXG4gIF9oYXNWYWxpZElucHV0KCkge1xyXG4gICAgcmV0dXJuICF0aGlzLl9pbnB1dExpc3QuZXZlcnkoKGlucHV0RWwpID0+IGlucHV0RWwudmFsaWRpdHkudmFsaWQpO1xyXG4gIH1cclxuXHJcbiAgdG9nZ2xlQnV0dG9uU3RhdGUoKSB7XHJcbiAgICBpZiAodGhpcy5faGFzVmFsaWRJbnB1dCgpKSB7XHJcbiAgICAgIHRoaXMuX2Rpc2FibGVCdXR0b24oKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuX2VuYWJsZUJ1dHRvbigpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgX2NoZWNrRm9ybVZhbGlkaXR5KGZvdW5kSW52YWxpZCkge1xyXG4gICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goKGlucHV0RWwpID0+IHtcclxuICAgICAgaWYgKCFpbnB1dEVsLnZhbGlkaXR5LnZhbGlkKSB7XHJcbiAgICAgICAgZm91bmRJbnZhbGlkID0gdHJ1ZTtcclxuICAgICAgfVxyXG4gICAgICByZXR1cm4gZm91bmRJbnZhbGlkO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBfZGlzYWJsZUJ1dHRvbigpIHtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5jbGFzc0xpc3QuYWRkKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uLmRpc2FibGVkID0gdHJ1ZTtcclxuICB9XHJcblxyXG4gIF9lbmFibGVCdXR0b24oKSB7XHJcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24uY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5kaXNhYmxlZCA9IGZhbHNlO1xyXG4gIH1cclxuXHJcbiAgY2hlY2tJbnB1dFZhbGlkaXR5KGZvcm1FbGVtZW50LCBpbnB1dEVsKSB7XHJcbiAgICBpZiAoIWlucHV0RWwudmFsaWRpdHkudmFsaWQpIHtcclxuICAgICAgdGhpcy5fc2hvd0lucHV0RXJyb3IoZm9ybUVsZW1lbnQsIGlucHV0RWwpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IoZm9ybUVsZW1lbnQsIGlucHV0RWwpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goKGlucHV0RWwpID0+IHtcclxuICAgICAgaW5wdXRFbC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgKCkgPT4ge1xyXG4gICAgICAgIHRoaXMuY2hlY2tJbnB1dFZhbGlkaXR5KHRoaXMuX2Zvcm1FbGVtZW50LCBpbnB1dEVsKTtcclxuICAgICAgICB0aGlzLnRvZ2dsZUJ1dHRvblN0YXRlKCk7XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBlbmFibGVWYWxpZGF0aW9uKCkge1xyXG4gICAgdGhpcy5fZm9ybUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZSkgPT4ge1xyXG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICB9KTtcclxuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgfVxyXG59XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcih7IHBvcHVwU2VsZWN0b3IgfSkge1xyXG4gICAgdGhpcy5fcG9wdXBFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihwb3B1cFNlbGVjdG9yKTtcclxuICAgIHRoaXMuX2Nsb3NlQnV0dG9uID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Nsb3NlXCIpO1xyXG4gIH1cclxuXHJcbiAgb3BlbigpIHtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudCA9IFwiU2F2ZVwiO1xyXG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmNsYXNzTGlzdC5hZGQoXCJtb2RhbF9vcGVuZWRcIik7XHJcbiAgICB0aGlzLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbiAgfVxyXG5cclxuICBjbG9zZSgpIHtcclxuICAgIHRoaXMuX2Nsb3NlQnV0dG9uLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCB0aGlzLl9oYW5kbGVDbG9zZUJ1dHRvbik7XHJcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIHRoaXMuX2hhbmRsZUNsaWNrQ2xvc2UpO1xyXG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoXCJtb2RhbF9vcGVuZWRcIik7XHJcbiAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XHJcbiAgfVxyXG5cclxuICBfaGFuZGxlQ2xvc2VCdXR0b24gPSAoKSA9PiB7XHJcbiAgICB0aGlzLmNsb3NlKCk7XHJcbiAgfTtcclxuXHJcbiAgX2hhbmRsZUNsaWNrQ2xvc2UgPSAoZSkgPT4ge1xyXG4gICAgaWYgKGUudGFyZ2V0ID09IHRoaXMuX3BvcHVwRWxlbWVudCkge1xyXG4gICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICB9XHJcbiAgfTtcclxuXHJcbiAgX2hhbmRsZUVzY0Nsb3NlID0gKGUpID0+IHtcclxuICAgIGlmIChlLmtleSA9PT0gXCJFc2NhcGVcIikge1xyXG4gICAgICB0aGlzLmNsb3NlKCk7XHJcbiAgICB9XHJcbiAgfTtcclxuXHJcbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICB0aGlzLl9jbG9zZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgdGhpcy5faGFuZGxlQ2xvc2VCdXR0b24pO1xyXG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCB0aGlzLl9oYW5kbGVDbGlja0Nsb3NlKTtcclxuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhGb3JtIGV4dGVuZHMgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IsIGhhbmRsZUZvcm1TdWJtaXQpIHtcclxuICAgIHN1cGVyKHsgcG9wdXBTZWxlY3RvciB9KTtcclxuICAgIHRoaXMuX3BvcHVwRm9ybSA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19mb3JtXCIpO1xyXG4gICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCA9IGhhbmRsZUZvcm1TdWJtaXQ7XHJcbiAgICB0aGlzLl9pbnB1dHMgPSB0aGlzLl9wb3B1cEZvcm0ucXVlcnlTZWxlY3RvckFsbChcIi5tb2RhbF9faW5wdXRcIik7XHJcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24gPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fYnV0dG9uXCIpO1xyXG4gIH1cclxuXHJcbiAgX2dldElucHV0VmFsdWVzKCkge1xyXG4gICAgY29uc3QgaW5wdXRWYWx1ZXMgPSB7fTtcclxuICAgIHRoaXMuX2lucHV0cy5mb3JFYWNoKChpbnB1dCkgPT4gKGlucHV0VmFsdWVzW2lucHV0Lm5hbWVdID0gaW5wdXQudmFsdWUpKTtcclxuICAgIHJldHVybiBpbnB1dFZhbHVlcztcclxuICB9XHJcblxyXG4gIGNsb3NlKCkge1xyXG4gICAgdGhpcy5fcG9wdXBGb3JtLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgdGhpcy5faGFuZGxlU3VibWl0QnV0dG9uKTtcclxuICAgIHRoaXMuX3BvcHVwRm9ybS5yZXNldCgpO1xyXG4gICAgc3VwZXIuY2xvc2UoKTtcclxuICB9XHJcblxyXG4gIF9oYW5kbGVTdWJtaXRCdXR0b24gPSAoZSkgPT4ge1xyXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uLnRleHRDb250ZW50ID0gXCJTYXZpbmcuLi5cIjtcclxuICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQodGhpcy5fZ2V0SW5wdXRWYWx1ZXMoKSk7XHJcbiAgICB0aGlzLmNsb3NlKCk7XHJcbiAgfTtcclxuXHJcbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xyXG4gICAgdGhpcy5fcG9wdXBGb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgdGhpcy5faGFuZGxlU3VibWl0QnV0dG9uKTtcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cERlbGV0ZSBleHRlbmRzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yLCBoYW5kbGVEZWxldGVDb25maXJtKSB7XHJcbiAgICBzdXBlcih7IHBvcHVwU2VsZWN0b3IgfSk7XHJcbiAgICB0aGlzLl9wb3B1cEZvcm0gPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybVwiKTtcclxuICAgIHRoaXMuX2hhbmRsZURlbGV0ZUNvbmZpcm0gPSBoYW5kbGVEZWxldGVDb25maXJtO1xyXG4gIH1cclxuXHJcbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xyXG4gICAgdGhpcy5fcG9wdXBGb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGUpID0+IHtcclxuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICB0aGlzLl9oYW5kbGVEZWxldGVDb25maXJtKCk7XHJcbiAgICAgIHN1cGVyLmNsb3NlKCk7XHJcbiAgICB9KTtcclxuICB9XHJcbn1cclxuIiwiLy8gISB8fC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tfHxcclxuLy8gISB8fCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEltcG9ydHMgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfHxcclxuLy8gISB8fC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tfHxcclxuXHJcbmltcG9ydCBDYXJkIGZyb20gXCIuLi9jb21wb25lbnRzL0NhcmQuanNcIjtcclxuaW1wb3J0IFNlY3Rpb24gZnJvbSBcIi4uL2NvbXBvbmVudHMvU2VjdGlvbi5qc1wiO1xyXG5pbXBvcnQgRm9ybVZhbGlkYXRvciBmcm9tIFwiLi4vY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzXCI7XHJcbmltcG9ydCBQb3B1cFdpdGhGb3JtIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanNcIjtcclxuaW1wb3J0IFBvcHVwV2l0aEltYWdlIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzXCI7XHJcbmltcG9ydCBQb3B1cERlbGV0ZSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cERlbGV0ZS5qc1wiO1xyXG5pbXBvcnQgVXNlckluZm8gZnJvbSBcIi4uL2NvbXBvbmVudHMvVXNlckluZm8uanNcIjtcclxuaW1wb3J0IFwiLi9pbmRleC5jc3NcIjtcclxuaW1wb3J0IENvbnN0YW50cyBmcm9tIFwiLi4vdXRpbHMvY29uc3RhbnRzLmpzXCI7XHJcbmltcG9ydCBBcGkgZnJvbSBcIi4uL2NvbXBvbmVudHMvQXBpLmpzXCI7XHJcblxyXG4vLyAhIHx8LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS18fFxyXG4vLyAhIHx8ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBBUEkgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8fFxyXG4vLyAhIHx8LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS18fFxyXG5cclxuY29uc3QgYXBpID0gbmV3IEFwaSh7XHJcbiAgYmFzZVVybDogXCJodHRwczovL2Fyb3VuZC1hcGkuZW4udHJpcGxldGVuLXNlcnZpY2VzLmNvbS92MVwiLFxyXG4gIGhlYWRlcnM6IHtcclxuICAgIGF1dGhvcml6YXRpb246IFwiN2Q5YjI2YjAtNzhkMC00MjJhLTk0MWEtMDljOTVlYTJiMDgyXCIsXHJcbiAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcclxuICB9LFxyXG59KTtcclxuXHJcbmFwaS5nZXRVc2VySW5mbygpLnRoZW4oKHVzZXJEYXRhKSA9PiB7XHJcbiAgcHJvZmlsZUluZm8uc2V0VXNlckluZm8oe1xyXG4gICAgbmFtZTogdXNlckRhdGEubmFtZSxcclxuICAgIGRlc2NyaXB0aW9uOiB1c2VyRGF0YS5hYm91dCxcclxuICB9KTtcclxufSk7XHJcblxyXG5hcGkuZ2V0VXNlckluZm8oKS50aGVuKCh1c2VyRGF0YSkgPT4ge1xyXG4gIGF2YXRhci5zZXRBdHRyaWJ1dGUoXCJzcmNcIiwgdXNlckRhdGEuYXZhdGFyKTtcclxufSk7XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVVcGRhdGVQcm9maWxlKHVzZXJEYXRhKSB7XHJcbiAgYXBpLnVwZGF0ZVByb2ZpbGUodXNlckRhdGEpLnRoZW4oKHVzZXJEYXRhKSA9PiB7XHJcbiAgICBwcm9maWxlSW5mby5zZXRVc2VySW5mbyh7XHJcbiAgICAgIG5hbWU6IHVzZXJEYXRhLm5hbWUsXHJcbiAgICAgIGRlc2NyaXB0aW9uOiB1c2VyRGF0YS5hYm91dCxcclxuICAgIH0pO1xyXG4gIH0pO1xyXG59XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVVcGRhdGVBdmF0YXIodXNlckRhdGEpIHtcclxuICBhcGkudXBkYXRlQXZhdGFyKHVzZXJEYXRhKTtcclxuICBhcGkuZ2V0VXNlckluZm8oKS50aGVuKCh1c2VyZGF0YSkgPT4ge1xyXG4gICAgYXZhdGFyLnNldEF0dHJpYnV0ZShcInNyY1wiLCB1c2VyRGF0YS5hdmF0YXIpO1xyXG4gIH0pO1xyXG59XHJcblxyXG4vLyAhIHx8LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS18fFxyXG4vLyAhIHx8ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIERlY2xhcmVkIFZhcmlhYmxlcyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB8fFxyXG4vLyAhIHx8LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS18fFxyXG5cclxuLy8gUHJvZmlsZSBFbGVtZW50c1xyXG5jb25zdCBlZGl0QnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19lZGl0LWJ1dHRvblwiKTtcclxuY29uc3QgYWRkQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19hZGQtYnV0dG9uXCIpO1xyXG4vLyBFZGl0IE1vZGFsIEVsZW1lbnRzXHJcbmNvbnN0IGVkaXRQb3B1cCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfdHlwZV9lZGl0XCIpO1xyXG5cclxuY29uc3QgcHJvZmlsZUZvcm0gPSBkb2N1bWVudC5mb3Jtc1tcInByb2ZpbGUtZm9ybVwiXTtcclxuXHJcbmNvbnN0IG1vZGFsSW5wdXROYW1lID0gZWRpdFBvcHVwLnF1ZXJ5U2VsZWN0b3IoXCIjbmFtZVwiKTtcclxuY29uc3QgbW9kYWxJbnB1dERlc2NyaXB0aW9uID0gZWRpdFBvcHVwLnF1ZXJ5U2VsZWN0b3IoXCIjZGVzY3JpcHRpb25cIik7XHJcbi8vIEF2YXRhciBNb2RhbCBFbGVtZW50c1xyXG5jb25zdCBhdmF0YXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2F2YXRhclwiKTtcclxuY29uc3QgYXZhdGFyT3ZlcmxheSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fYXZhdGFyLW92ZXJsYXlcIik7XHJcbmNvbnN0IGF2YXRhclBvcHVwID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF90eXBlX2F2YXRhclwiKTtcclxuY29uc3QgbW9kYWxJbnB1dEF2YXRhciA9IGF2YXRhclBvcHVwLnF1ZXJ5U2VsZWN0b3IoXCIjYXZhdGFyLWxpbmtcIik7XHJcbmNvbnN0IGF2YXRhckZvcm0gPSBkb2N1bWVudC5mb3Jtc1tcImF2YXRhci1mb3JtXCJdO1xyXG4vLyBDYXJkIE1vZGFsIEVsZW1lbnRzXHJcbmNvbnN0IGNhcmRGb3JtID0gZG9jdW1lbnQuZm9ybXNbXCJjYXJkLWZvcm1cIl07XHJcbi8vIENhcmQgTGlzdCBFbGVtZW50c1xyXG5jb25zdCBjYXJkTGlzdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuZ2FsbGVyeV9fY2FyZHNcIik7XHJcbmNvbnN0IGNhcmRUZW1wbGF0ZSA9IGNhcmRMaXN0XHJcbiAgLnF1ZXJ5U2VsZWN0b3IoXCIjZ2FsbGVyeS10ZW1wbGF0ZVwiKVxyXG4gIC5jb250ZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZFwiKTtcclxuXHJcbi8vICEgfHwtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLXx8XHJcbi8vICEgfHwgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBDYXJkIEZ1bmN0aW9ucyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHx8XHJcbi8vICEgfHwtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLXx8XHJcblxyXG5mdW5jdGlvbiBoYW5kbGVJbWFnZUNsaWNrKGNhcmREYXRhKSB7XHJcbiAgaW1hZ2VQb3B1cC5vcGVuKGNhcmREYXRhKTtcclxufVxyXG5cclxuLy8gISB8fC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tfHxcclxuLy8gISB8fCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEV2ZW50IExpc3RlbmVycyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfHxcclxuLy8gISB8fC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tfHxcclxuXHJcbmVkaXRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICBjb25zdCB7IG5hbWUsIGRlc2NyaXB0aW9uIH0gPSBwcm9maWxlSW5mby5nZXRVc2VySW5mbygpO1xyXG4gIG1vZGFsSW5wdXROYW1lLnZhbHVlID0gbmFtZTtcclxuICBtb2RhbElucHV0RGVzY3JpcHRpb24udmFsdWUgPSBkZXNjcmlwdGlvbjtcclxuICBlZGl0UHJvZmlsZVBvcHVwLm9wZW4oKTtcclxufSk7XHJcblxyXG5hdmF0YXJPdmVybGF5LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgY29uc29sZS5sb2coXCJIZWxsbyBmcm9tIGF2YXRhciBjbGlja1wiKTtcclxuICB1cGRhdGVBdmF0YXJQb3B1cC5vcGVuKCk7XHJcbn0pO1xyXG5cclxuLy8gISB8fC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tfHxcclxuLy8gISB8fCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBDbGFzcyBJbnN0YW50aWF0aW9uICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfHxcclxuLy8gISB8fC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tfHxcclxuXHJcbmNvbnN0IGNvbnN0YW50cyA9IG5ldyBDb25zdGFudHMoKTtcclxuXHJcbmNvbnN0IGVkaXRGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IoXHJcbiAgY29uc3RhbnRzLnZhbGlkYXRpb25TZXR0aW5ncyxcclxuICBwcm9maWxlRm9ybVxyXG4pO1xyXG5jb25zdCBhZGRGb3JtVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IoXHJcbiAgY29uc3RhbnRzLnZhbGlkYXRpb25TZXR0aW5ncyxcclxuICBjYXJkRm9ybVxyXG4pO1xyXG5cclxuY29uc3QgYXZhdGFyRm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKFxyXG4gIGNvbnN0YW50cy52YWxpZGF0aW9uU2V0dGluZ3MsXHJcbiAgYXZhdGFyRm9ybVxyXG4pO1xyXG5cclxuY29uc3QgcHJvZmlsZUluZm8gPSBuZXcgVXNlckluZm8oe1xyXG4gIG5hbWU6IFwiLnByb2ZpbGVfX25hbWVcIixcclxuICBkZXNjcmlwdGlvbjogXCIucHJvZmlsZV9fZGVzY3JpcHRpb25cIixcclxufSk7XHJcblxyXG5jb25zdCBlZGl0UHJvZmlsZVBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oXCIjZWRpdC1wb3B1cFwiLCBoYW5kbGVVcGRhdGVQcm9maWxlKTtcclxuXHJcbmNvbnN0IHVwZGF0ZUF2YXRhclBvcHVwID0gbmV3IFBvcHVwV2l0aEZvcm0oXHJcbiAgXCIjYXZhdGFyLXBvcHVwXCIsXHJcbiAgaGFuZGxlVXBkYXRlQXZhdGFyXHJcbik7XHJcblxyXG5jb25zdCBpbWFnZVBvcHVwID0gbmV3IFBvcHVwV2l0aEltYWdlKFwiI3ByZXZpZXctaW1hZ2UtcG9wdXBcIik7XHJcblxyXG5lZGl0Rm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XHJcbmFkZEZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xyXG5hdmF0YXJGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcclxuXHJcbi8vICEgfHwtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLXx8XHJcbi8vICEgfHwgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEdhbGxlcnkgQ3JlYXRpb24gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHx8XHJcbi8vICEgfHwtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLXx8XHJcblxyXG5hcGkuZ2V0SW5pdGlhbENhcmRzKCkudGhlbigoY2FyZHMpID0+IHtcclxuICBjb25zdCBjYXJkR2FsbGVyeSA9IG5ldyBTZWN0aW9uKFxyXG4gICAgeyBpdGVtczogY2FyZHMsIHJlbmRlcmVyOiByZW5kZXJDYXJkIH0sXHJcbiAgICBcIi5nYWxsZXJ5X19jYXJkc1wiXHJcbiAgKTtcclxuXHJcbiAgZnVuY3Rpb24gcmVuZGVyQ2FyZChjYXJkRGF0YSkge1xyXG4gICAgY29uc3QgY2FyZCA9IG5ldyBDYXJkKFxyXG4gICAgICB7XHJcbiAgICAgICAgY2FyZERhdGEsXHJcblxyXG4gICAgICAgIGhhbmRsZUltYWdlQ2xpY2ssXHJcbiAgICAgICAgaGFuZGxlRGVsZXRlQnV0dG9uLFxyXG4gICAgICAgIGhhbmRsZUNhcmRMaWtlLFxyXG4gICAgICAgIGhhbmRsZUNhcmRVbmxpa2UsXHJcbiAgICAgIH0sXHJcbiAgICAgIGNhcmRUZW1wbGF0ZVxyXG4gICAgKTtcclxuXHJcbiAgICBmdW5jdGlvbiBoYW5kbGVEZWxldGVCdXR0b24oKSB7XHJcbiAgICAgIGRlbGV0ZVBvcHVwLm9wZW4oKTtcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBoYW5kbGVDYXJkTGlrZShpZCkge1xyXG4gICAgICBhcGkubGlrZUNhcmQoaWQpO1xyXG4gICAgfVxyXG5cclxuICAgIGZ1bmN0aW9uIGhhbmRsZUNhcmRVbmxpa2UoaWQpIHtcclxuICAgICAgYXBpLnVubGlrZUNhcmQoaWQpO1xyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IGhhbmRsZURlbGV0ZVN1Ym1pdCA9ICgpID0+IHtcclxuICAgICAgbGV0IGlkID0gY2FyZC5nZXRJZCgpO1xyXG4gICAgICBhcGkucmVtb3ZlQ2FyZChpZCk7XHJcbiAgICAgIGNhcmQucmVtb3ZlSXRlbSgpO1xyXG4gICAgICAvLyBGb3Igc29tZSByZWFzb24sIHdoZW4gdGhpcyBmdW5jdGlvbiBpcyBjYWxsZWQgY29uc2VjdXRpdmVseSxcclxuICAgICAgLy8gaXQgc2F2ZXMgdGhlIGNhcmQncyBJRCBmcm9tIGVhY2ggcHJldmlvdXMgdGltZSBpdCB3YXMgY2FsbGVkLFxyXG4gICAgICAvLyBzbyBpdCB0cmllcyB0byBkZWxldGUgdGhvc2UgSURzIGFzIHdlbGwuXHJcbiAgICB9O1xyXG5cclxuICAgIGNvbnN0IGRlbGV0ZVBvcHVwID0gbmV3IFBvcHVwRGVsZXRlKFwiI2RlbGV0ZS1wb3B1cFwiLCBoYW5kbGVEZWxldGVTdWJtaXQpO1xyXG5cclxuICAgIHJldHVybiBjYXJkLmdldFZpZXcoKTtcclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIGhhbmRsZUFkZENhcmQoeyB0aXRsZTogbmFtZSwgbGluazogbGluayB9KSB7XHJcbiAgICBhcGkuYWRkQ2FyZCh7IG5hbWUsIGxpbmsgfSkudGhlbigoZGF0YSkgPT4ge1xyXG4gICAgICBjYXJkR2FsbGVyeS5hZGRJdGVtKGRhdGEpO1xyXG4gICAgfSk7XHJcbiAgICBuZXdDYXJkUG9wdXAuY2xvc2UoKTtcclxuICB9XHJcblxyXG4gIGNvbnN0IG5ld0NhcmRQb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKFwiI25ldy1jYXJkLXBvcHVwXCIsIGhhbmRsZUFkZENhcmQpO1xyXG5cclxuICBhZGRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgIGFkZEZvcm1WYWxpZGF0b3IudG9nZ2xlQnV0dG9uU3RhdGUoKTtcclxuICAgIG5ld0NhcmRQb3B1cC5vcGVuKCk7XHJcbiAgfSk7XHJcblxyXG4gIGNhcmRHYWxsZXJ5LnJlbmRlckl0ZW1zKCk7XHJcbn0pO1xyXG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBBcGkge1xyXG4gIGNvbnN0cnVjdG9yKHsgYmFzZVVybCwgaGVhZGVycyB9KSB7XHJcbiAgICB0aGlzLl9iYXNlVXJsID0gYmFzZVVybDtcclxuICAgIHRoaXMuX2hlYWRlcnMgPSBoZWFkZXJzO1xyXG4gICAgdGhpcy5fdG9rZW4gPSBoZWFkZXJzLmF1dGhvcml6YXRpb247XHJcbiAgfVxyXG5cclxuICBnZXRJbml0aWFsQ2FyZHMoKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCB7XHJcbiAgICAgIGhlYWRlcnM6IHtcclxuICAgICAgICBhdXRob3JpemF0aW9uOiB0aGlzLl90b2tlbixcclxuICAgICAgfSxcclxuICAgIH0pXHJcbiAgICAgIC50aGVuKChyZXMpID0+IHtcclxuICAgICAgICBpZiAocmVzLm9rKSB7XHJcbiAgICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xyXG4gICAgICB9KVxyXG4gICAgICAuY2F0Y2goKGVycikgPT4ge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcclxuICAgICAgfSk7XHJcbiAgfVxyXG5cclxuICBnZXRVc2VySW5mbygpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZWAsIHtcclxuICAgICAgaGVhZGVyczoge1xyXG4gICAgICAgIGF1dGhvcml6YXRpb246IHRoaXMuX3Rva2VuLFxyXG4gICAgICB9LFxyXG4gICAgfSlcclxuICAgICAgLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICAgIGlmIChyZXMub2spIHtcclxuICAgICAgICAgIHJldHVybiByZXMuanNvbigpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XHJcbiAgICAgIH0pXHJcbiAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcihlcnIpO1xyXG4gICAgICB9KTtcclxuICB9XHJcblxyXG4gIGdldEF2YXRhcigpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZWAsIHtcclxuICAgICAgaGVhZGVyczoge1xyXG4gICAgICAgIGF1dGhvcml6YXRpb246IHRoaXMuX3Rva2VuLFxyXG4gICAgICB9LFxyXG4gICAgfSlcclxuICAgICAgLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICAgIGlmIChyZXMub2spIHtcclxuICAgICAgICAgIHJldHVybiByZXMuanNvbigpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XHJcbiAgICAgIH0pXHJcbiAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcihlcnIpO1xyXG4gICAgICB9KTtcclxuICB9XHJcblxyXG4gIGdldElkKCkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzLzpjYXJkSWRgLCB7XHJcbiAgICAgIGhlYWRlcnM6IHtcclxuICAgICAgICBhdXRob3JpemF0aW9uOiB0aGlzLl90b2tlbixcclxuICAgICAgfSxcclxuICAgIH0pXHJcbiAgICAgIC50aGVuKChyZXMpID0+IHtcclxuICAgICAgICBpZiAocmVzLm9rKSB7XHJcbiAgICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xyXG4gICAgICB9KVxyXG4gICAgICAuY2F0Y2goKGVycikgPT4ge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcclxuICAgICAgfSk7XHJcbiAgfVxyXG5cclxuICB1cGRhdGVQcm9maWxlKHVzZXJEYXRhKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWVgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxyXG4gICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgYXV0aG9yaXphdGlvbjogdGhpcy5fdG9rZW4sXHJcbiAgICAgICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXHJcbiAgICAgIH0sXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICBuYW1lOiB1c2VyRGF0YS5uYW1lLFxyXG4gICAgICAgIGFib3V0OiB1c2VyRGF0YS5kZXNjcmlwdGlvbixcclxuICAgICAgfSksXHJcbiAgICB9KVxyXG4gICAgICAudGhlbigocmVzKSA9PiB7XHJcbiAgICAgICAgaWYgKHJlcy5vaykge1xyXG4gICAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcclxuICAgICAgfSlcclxuICAgICAgLmNhdGNoKChlcnIpID0+IHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKGVycik7XHJcbiAgICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgdXBkYXRlQXZhdGFyKGxpbmspIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZS9hdmF0YXJgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxyXG4gICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgYXV0aG9yaXphdGlvbjogdGhpcy5fdG9rZW4sXHJcbiAgICAgICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXHJcbiAgICAgIH0sXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHsgYXZhdGFyOiBsaW5rLmF2YXRhciB9KSxcclxuICAgIH0pXHJcbiAgICAgIC50aGVuKChyZXMpID0+IHtcclxuICAgICAgICBpZiAocmVzLm9rKSB7XHJcbiAgICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xyXG4gICAgICB9KVxyXG4gICAgICAuY2F0Y2goKGVycikgPT4ge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcclxuICAgICAgfSk7XHJcbiAgfVxyXG5cclxuICBhZGRDYXJkKHsgbmFtZSwgbGluayB9KSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJQT1NUXCIsXHJcbiAgICAgIGhlYWRlcnM6IHtcclxuICAgICAgICBhdXRob3JpemF0aW9uOiB0aGlzLl90b2tlbixcclxuICAgICAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcclxuICAgICAgfSxcclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgIG5hbWUsXHJcbiAgICAgICAgbGluayxcclxuICAgICAgfSksXHJcbiAgICB9KVxyXG4gICAgICAudGhlbigocmVzKSA9PiB7XHJcbiAgICAgICAgaWYgKHJlcy5vaykge1xyXG4gICAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcclxuICAgICAgfSlcclxuICAgICAgLmNhdGNoKChlcnIpID0+IHtcclxuICAgICAgICBjb25zb2xlLmVycm9yKGVycik7XHJcbiAgICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgcmVtb3ZlQ2FyZChjYXJkSUQpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy8ke2NhcmRJRH1gLCB7XHJcbiAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcclxuICAgICAgaGVhZGVyczoge1xyXG4gICAgICAgIGF1dGhvcml6YXRpb246IHRoaXMuX3Rva2VuLFxyXG4gICAgICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxyXG4gICAgICAgIG1lc3NhZ2U6IFwiVGhpcyBwb3N0IGhhcyBiZWVuIGRlbGV0ZWRcIixcclxuICAgICAgfSxcclxuICAgIH0pXHJcbiAgICAgIC50aGVuKChyZXMpID0+IHtcclxuICAgICAgICBpZiAocmVzLm9rKSB7XHJcbiAgICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xyXG4gICAgICB9KVxyXG4gICAgICAuY2F0Y2goKGVycikgPT4ge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcclxuICAgICAgfSk7XHJcbiAgfVxyXG5cclxuICBsaWtlQ2FyZChjYXJkSWQpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS9jYXJkcy8ke2NhcmRJZH0vbGlrZXNgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJQVVRcIixcclxuICAgICAgaGVhZGVyczoge1xyXG4gICAgICAgIGF1dGhvcml6YXRpb246IHRoaXMuX3Rva2VuLFxyXG4gICAgICB9LFxyXG4gICAgfSlcclxuICAgICAgLnRoZW4oKHJlcykgPT4ge1xyXG4gICAgICAgIGlmIChyZXMub2spIHtcclxuICAgICAgICAgIHJldHVybiByZXMuanNvbigpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XHJcbiAgICAgIH0pXHJcbiAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XHJcbiAgICAgICAgY29uc29sZS5lcnJvcihlcnIpO1xyXG4gICAgICB9KTtcclxuICB9XHJcblxyXG4gIHVubGlrZUNhcmQoY2FyZElkKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvJHtjYXJkSWR9L2xpa2VzYCwge1xyXG4gICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXHJcbiAgICAgIGhlYWRlcnM6IHtcclxuICAgICAgICBhdXRob3JpemF0aW9uOiB0aGlzLl90b2tlbixcclxuICAgICAgfSxcclxuICAgIH0pXHJcbiAgICAgIC50aGVuKChyZXMpID0+IHtcclxuICAgICAgICBpZiAocmVzLm9rKSB7XHJcbiAgICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xyXG4gICAgICB9KVxyXG4gICAgICAuY2F0Y2goKGVycikgPT4ge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyKTtcclxuICAgICAgfSk7XHJcbiAgfVxyXG59XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIENvbnN0YW50cyB7XHJcbiAgY29uc3RydWN0b3IoKSB7XHJcbiAgICAvLyAhIHx8LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS18fFxyXG4gICAgLy8gISB8fCAgICAgICAgICAgICAgICAgICAgICAgICAgICBGb3JtIFZhbGlkYXRpb24gU2VsZWN0b3JzICAgICAgICAgICAgICAgICAgICAgICAgICAgfHxcclxuICAgIC8vICEgfHwtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLXx8XHJcblxyXG4gICAgdGhpcy52YWxpZGF0aW9uU2V0dGluZ3MgPSB7XHJcbiAgICAgIGZvcm1TZWxlY3RvcjogXCIubW9kYWxfX2Zvcm1cIixcclxuICAgICAgaW5wdXRTZWxlY3RvcjogXCIubW9kYWxfX2lucHV0XCIsXHJcbiAgICAgIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiBcIi5tb2RhbF9fYnV0dG9uXCIsXHJcbiAgICAgIGluYWN0aXZlQnV0dG9uQ2xhc3M6IFwibW9kYWxfX2J1dHRvbl9kaXNhYmxlZFwiLFxyXG4gICAgICBpbnB1dEVycm9yQ2xhc3M6IFwibW9kYWxfX2lucHV0X3R5cGVfZXJyb3JcIixcclxuICAgICAgZXJyb3JDbGFzczogXCJtb2RhbF9fZXJyb3JfdmlzaWJsZVwiLFxyXG4gICAgfTtcclxuICB9XHJcbn1cclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgVXNlckluZm8ge1xyXG4gIGNvbnN0cnVjdG9yKHsgbmFtZSwgZGVzY3JpcHRpb24gfSkge1xyXG4gICAgdGhpcy5fbmFtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IobmFtZSk7XHJcbiAgICB0aGlzLl9kZXNjcmlwdGlvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoZGVzY3JpcHRpb24pO1xyXG4gIH1cclxuXHJcbiAgZ2V0VXNlckluZm8oKSB7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBuYW1lOiB0aGlzLl9uYW1lLnRleHRDb250ZW50LFxyXG4gICAgICBkZXNjcmlwdGlvbjogdGhpcy5fZGVzY3JpcHRpb24udGV4dENvbnRlbnQsXHJcbiAgICB9O1xyXG4gIH1cclxuXHJcbiAgc2V0VXNlckluZm8oeyBuYW1lLCBkZXNjcmlwdGlvbiB9KSB7XHJcbiAgICB0aGlzLl9uYW1lLnRleHRDb250ZW50ID0gbmFtZTtcclxuICAgIHRoaXMuX2Rlc2NyaXB0aW9uLnRleHRDb250ZW50ID0gZGVzY3JpcHRpb247XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoSW1hZ2UgZXh0ZW5kcyBQb3B1cCB7XHJcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xyXG4gICAgc3VwZXIoeyBwb3B1cFNlbGVjdG9yIH0pO1xyXG4gICAgdGhpcy5fcHJldmlld0ltYWdlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fcHJldmlldy1pbWFnZVwiKTtcclxuICAgIHRoaXMuX3ByZXZpZXdOYW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fcHJldmlldy1uYW1lXCIpO1xyXG4gIH1cclxuXHJcbiAgb3Blbih7IG5hbWUsIGxpbmsgfSkge1xyXG4gICAgdGhpcy5fcHJldmlld0ltYWdlLnNyYyA9IGxpbms7XHJcbiAgICB0aGlzLl9wcmV2aWV3SW1hZ2UuYWx0ID0gbmFtZTtcclxuICAgIHRoaXMuX3ByZXZpZXdOYW1lLnRleHRDb250ZW50ID0gbmFtZTtcclxuICAgIHN1cGVyLm9wZW4oKTtcclxuICB9XHJcbn1cclxuIl0sIm5hbWVzIjpbIkNhcmQiLCJjb25zdHJ1Y3RvciIsIl9yZWYiLCJjYXJkU2VsZWN0b3IiLCJjYXJkRGF0YSIsImhhbmRsZUltYWdlQ2xpY2siLCJoYW5kbGVEZWxldGVCdXR0b24iLCJoYW5kbGVDYXJkTGlrZSIsImhhbmRsZUNhcmRVbmxpa2UiLCJ0aGlzIiwiX2NhcmRTZWxlY3RvciIsIl9uYW1lIiwibmFtZSIsIl9saW5rIiwibGluayIsIl9pZCIsIl9oYW5kbGVJbWFnZUNsaWNrIiwiX2hhbmRsZURlbGV0ZUJ1dHRvbiIsIl9oYW5kbGVDYXJkTGlrZSIsIl9oYW5kbGVDYXJkVW5saWtlIiwiX2dldFRlbXBsYXRlIiwiY2xvbmVOb2RlIiwiZ2V0SWQiLCJyZW1vdmVJdGVtIiwiX2VsZW1lbnQiLCJyZW1vdmUiLCJfaGFuZGxlTGlrZUJ1dHRvbiIsIl9saWtlQnV0dG9uIiwiY2xhc3NMaXN0IiwiY29udGFpbnMiLCJhZGQiLCJfc2V0RXZlbnRMaXN0ZW5lcnMiLCJhZGRFdmVudExpc3RlbmVyIiwiX2RlbGV0ZUJ1dHRvbiIsIl9jYXJkSW1hZ2UiLCJnZXRWaWV3IiwicXVlcnlTZWxlY3RvciIsIl9jYXJkTmFtZUNvbnRlbnQiLCJzZXRBdHRyaWJ1dGUiLCJ0ZXh0Q29udGVudCIsIlNlY3Rpb24iLCJjb250YWluZXJTZWxlY3RvciIsIml0ZW1zIiwicmVuZGVyZXIiLCJfaXRlbXMiLCJfcmVuZGVyZXIiLCJfY29udGFpbmVyIiwiZG9jdW1lbnQiLCJyZW5kZXJJdGVtcyIsImZvckVhY2giLCJhZGRJdGVtIiwiY2FyZEVsZW1lbnQiLCJwcmVwZW5kIiwiRm9ybVZhbGlkYXRvciIsInNldHRpbmdzIiwiZm9ybUVsZW1lbnQiLCJfaW5wdXRTZWxlY3RvciIsImlucHV0U2VsZWN0b3IiLCJfc3VibWl0QnV0dG9uU2VsZWN0b3IiLCJzdWJtaXRCdXR0b25TZWxlY3RvciIsIl9pbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsIl9pbnB1dEVycm9yQ2xhc3MiLCJpbnB1dEVycm9yQ2xhc3MiLCJfZXJyb3JDbGFzcyIsImVycm9yQ2xhc3MiLCJfZm9ybUVsZW1lbnQiLCJfc3VibWl0QnV0dG9uIiwiX2lucHV0TGlzdCIsIkFycmF5IiwiZnJvbSIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJfc2hvd0lucHV0RXJyb3IiLCJpbnB1dEVsZW1lbnQiLCJlcnJvckVsZW1lbnQiLCJpZCIsInZhbGlkYXRpb25NZXNzYWdlIiwiX2hpZGVJbnB1dEVycm9yIiwiX2hhc1ZhbGlkSW5wdXQiLCJldmVyeSIsImlucHV0RWwiLCJ2YWxpZGl0eSIsInZhbGlkIiwidG9nZ2xlQnV0dG9uU3RhdGUiLCJfZGlzYWJsZUJ1dHRvbiIsIl9lbmFibGVCdXR0b24iLCJfY2hlY2tGb3JtVmFsaWRpdHkiLCJmb3VuZEludmFsaWQiLCJkaXNhYmxlZCIsImNoZWNrSW5wdXRWYWxpZGl0eSIsImVuYWJsZVZhbGlkYXRpb24iLCJlIiwicHJldmVudERlZmF1bHQiLCJQb3B1cCIsInBvcHVwU2VsZWN0b3IiLCJfcG9wdXBFbGVtZW50IiwiX2Nsb3NlQnV0dG9uIiwib3BlbiIsInNldEV2ZW50TGlzdGVuZXJzIiwiY2xvc2UiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwiX2hhbmRsZUNsb3NlQnV0dG9uIiwiX2hhbmRsZUNsaWNrQ2xvc2UiLCJfaGFuZGxlRXNjQ2xvc2UiLCJ0YXJnZXQiLCJrZXkiLCJQb3B1cFdpdGhGb3JtIiwiaGFuZGxlRm9ybVN1Ym1pdCIsInN1cGVyIiwiX3BvcHVwRm9ybSIsIl9oYW5kbGVGb3JtU3VibWl0IiwiX2lucHV0cyIsIl9nZXRJbnB1dFZhbHVlcyIsImlucHV0VmFsdWVzIiwiaW5wdXQiLCJ2YWx1ZSIsIl9oYW5kbGVTdWJtaXRCdXR0b24iLCJyZXNldCIsIlBvcHVwRGVsZXRlIiwiaGFuZGxlRGVsZXRlQ29uZmlybSIsIl9oYW5kbGVEZWxldGVDb25maXJtIiwiYXBpIiwiYmFzZVVybCIsImhlYWRlcnMiLCJfYmFzZVVybCIsIl9oZWFkZXJzIiwiX3Rva2VuIiwiYXV0aG9yaXphdGlvbiIsImdldEluaXRpYWxDYXJkcyIsImZldGNoIiwidGhlbiIsInJlcyIsIm9rIiwianNvbiIsIlByb21pc2UiLCJyZWplY3QiLCJzdGF0dXMiLCJjYXRjaCIsImVyciIsImNvbnNvbGUiLCJlcnJvciIsImdldFVzZXJJbmZvIiwiZ2V0QXZhdGFyIiwidXBkYXRlUHJvZmlsZSIsInVzZXJEYXRhIiwibWV0aG9kIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJhYm91dCIsImRlc2NyaXB0aW9uIiwidXBkYXRlQXZhdGFyIiwiYXZhdGFyIiwiYWRkQ2FyZCIsIl9yZWYyIiwicmVtb3ZlQ2FyZCIsImNhcmRJRCIsIm1lc3NhZ2UiLCJsaWtlQ2FyZCIsImNhcmRJZCIsInVubGlrZUNhcmQiLCJwcm9maWxlSW5mbyIsInNldFVzZXJJbmZvIiwiZWRpdEJ1dHRvbiIsImFkZEJ1dHRvbiIsImVkaXRQb3B1cCIsInByb2ZpbGVGb3JtIiwiZm9ybXMiLCJtb2RhbElucHV0TmFtZSIsIm1vZGFsSW5wdXREZXNjcmlwdGlvbiIsImF2YXRhck92ZXJsYXkiLCJhdmF0YXJGb3JtIiwiY2FyZEZvcm0iLCJjYXJkVGVtcGxhdGUiLCJjb250ZW50IiwiaW1hZ2VQb3B1cCIsImVkaXRQcm9maWxlUG9wdXAiLCJsb2ciLCJ1cGRhdGVBdmF0YXJQb3B1cCIsImNvbnN0YW50cyIsInZhbGlkYXRpb25TZXR0aW5ncyIsImZvcm1TZWxlY3RvciIsImVkaXRGb3JtVmFsaWRhdG9yIiwiYWRkRm9ybVZhbGlkYXRvciIsImF2YXRhckZvcm1WYWxpZGF0b3IiLCJfZGVzY3JpcHRpb24iLCJ1c2VyZGF0YSIsIl9wcmV2aWV3SW1hZ2UiLCJfcHJldmlld05hbWUiLCJzcmMiLCJhbHQiLCJjYXJkcyIsImNhcmRHYWxsZXJ5IiwiY2FyZCIsImRlbGV0ZVBvcHVwIiwiaGFuZGxlRGVsZXRlU3VibWl0IiwibmV3Q2FyZFBvcHVwIiwidGl0bGUiLCJkYXRhIl0sInNvdXJjZVJvb3QiOiIifQ==